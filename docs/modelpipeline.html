---

title: Model Pipeline


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/06_modelpipeline.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_modelpipeline.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">load_ext</span> nb_black
<span class="o">%</span><span class="k">load_ext</span> lab_black
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="9f5b4895-1c43-42ca-bb11-f63bef5e4931"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#9f5b4895-1c43-42ca-bb11-f63bef5e4931');

            setTimeout(function() {
                var nbb_cell_id = 1;
                var nbb_unformatted_code = "%load_ext autoreload\n%autoreload 2\n%load_ext nb_black\n%load_ext lab_black";
                var nbb_formatted_code = "%load_ext autoreload\n%autoreload 2\n%load_ext nb_black\n%load_ext lab_black";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The functionality below uses the <a href="/numerai_blocks/dataset.html#Dataset"><code>Dataset</code></a>, <code>PreProcessor</code>, <code>Model</code> and <code>PostProcessor</code> objects to easily propagate
data and generate predictions that are ready to submit.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-ModelPipeline">1. ModelPipeline<a class="anchor-link" href="#1.-ModelPipeline"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerai_blocks/modelpipeline.html#ModelPipeline"><code>ModelPipeline</code></a> handles all preprocessing, model prediction and postprocessing.
After the <a href="/numerai_blocks/modelpipeline.html#ModelPipeline"><code>ModelPipeline</code></a> completes it returns a <a href="/numerai_blocks/dataset.html#Dataset"><code>Dataset</code></a> with the original data, metadata and added prediction columns.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ModelPipeline" class="doc_header"><code>class</code> <code>ModelPipeline</code><a href="https://github.com/crowdcent/numerai_blocks/tree/main/numerai_blocks/model_pipeline.py#L19" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ModelPipeline</code>(<strong><code>models</code></strong>:<code>List</code>[<a href="/numerai_blocks/model.html#BaseModel"><code>BaseModel</code></a>], <strong><code>preprocessors</code></strong>:<code>List</code>[<a href="/numerai_blocks/preprocessing.html#BaseProcessor"><code>BaseProcessor</code></a>]=<em><code>[]</code></em>, <strong><code>postprocessors</code></strong>:<code>List</code>[<a href="/numerai_blocks/preprocessing.html#BaseProcessor"><code>BaseProcessor</code></a>]=<em><code>[]</code></em>, <strong><code>copy_first</code></strong>=<em><code>True</code></em>, <strong><code>standardize</code></strong>=<em><code>True</code></em>, <strong><code>pipeline_name</code></strong>:<code>str</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Execute all preprocessing, prediction and postprocessing for a given setup.</p>
<p>:param models: Initiliazed (!) numerai-blocks Models that add prediction columns to a given input Dataset
:param preprocessors: List of initialized (!) PreProcessors.
:param postprocessors: List of initialized (!) PostProcessors.
:param copy_first: Whether to copy the Dataset as a first preprocessing step.
Highly recommended in order to avoid accidentally manipulating the original Dataset and/or DataFrame.
:param pipeline_name: Unique name for pipeline.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="ce915549-976b-450b-b197-4dadbbb7a8f1"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#ce915549-976b-450b-b197-4dadbbb7a8f1');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "#export\n@typechecked\nclass ModelPipeline:\n    \"\"\"\n    Execute all preprocessing, prediction and postprocessing for a given setup.\n\n    :param models: Initiliazed (!) numerai-blocks Models that add prediction columns to a given input Dataset\n    :param preprocessors: List of initialized (!) PreProcessors.\n    :param postprocessors: List of initialized (!) PostProcessors.\n    :param copy_first: Whether to copy the Dataset as a first preprocessing step.\n    Highly recommended in order to avoid accidentally manipulating the original Dataset and/or DataFrame.\n    :param pipeline_name: Unique name for pipeline.\n    \"\"\"\n    def __init__(self,\n                 models: List[BaseModel],\n                 preprocessors: List[BaseProcessor] = [],\n                 postprocessors: List[BaseProcessor] = [],\n                 copy_first = True,\n                 standardize = True,\n                 pipeline_name: str = None):\n        self.pipeline_name = pipeline_name if pipeline_name else uuid.uuid4().hex\n        self.models = models\n        self.copy_first = copy_first\n        self.standardize = standardize\n        self.preprocessors = preprocessors\n        self.postprocessors = postprocessors\n\n    def preprocess(self, dataset: Dataset) -> Dataset:\n        if self.copy_first:\n            dataset = CopyPreProcessor()(dataset)\n        for preprocessor in tqdm(self.preprocessors,\n                                 desc=f\"{self.pipeline_name} Preprocessing:\",\n                                 position=0):\n            rich_print(f\":construction: Applying preprocessing: '[bold]{preprocessor.__class__.__name__}[/bold]' :construction:\")\n            dataset = preprocessor(dataset)\n        return dataset\n\n    def postprocess(self, dataset: Dataset) -> Dataset:\n        if self.standardize:\n            dataset = Standardizer()(dataset)\n        for postprocessor in tqdm(self.postprocessors,\n                                  desc=f\"{self.pipeline_name} Postprocessing: \",\n                                  position=0):\n            rich_print(f\":construction: Applying postprocessing: '[bold]{postprocessor.__class__.__name__}[/bold]' :construction:\")\n            dataset = postprocessor(dataset)\n        return dataset\n\n    def process_models(self, dataset: Dataset) -> Dataset:\n        for model in tqdm(self.models,\n                                  desc=f\"{self.pipeline_name} Model prediction: \",\n                                  position=0):\n            rich_print(f\":robot: Generating model predictions with '[bold]{model.__class__.__name__}[/bold]'. :robot:\")\n            dataset = model(dataset)\n        return dataset\n\n    def pipeline(self, dataset: Dataset) -> Dataset:\n        \"\"\" Process full pipeline and return resulting Dataset. \"\"\"\n        preprocessed_dataset = self.preprocess(dataset)\n        prediction_dataset = self.process_models(preprocessed_dataset)\n        processed_prediction_dataset = self.postprocess(prediction_dataset)\n        rich_print(f\":checkered_flag: [green]Finished pipeline:[green] [bold blue]'{self.pipeline_name}'[bold blue]! :checkered_flag:\")\n        return processed_prediction_dataset\n\n    def __call__(self, dataset: Dataset):\n        return self.pipeline(dataset)";
                var nbb_formatted_code = "# export\n@typechecked\nclass ModelPipeline:\n    \"\"\"\n    Execute all preprocessing, prediction and postprocessing for a given setup.\n\n    :param models: Initiliazed (!) numerai-blocks Models that add prediction columns to a given input Dataset\n    :param preprocessors: List of initialized (!) PreProcessors.\n    :param postprocessors: List of initialized (!) PostProcessors.\n    :param copy_first: Whether to copy the Dataset as a first preprocessing step.\n    Highly recommended in order to avoid accidentally manipulating the original Dataset and/or DataFrame.\n    :param pipeline_name: Unique name for pipeline.\n    \"\"\"\n\n    def __init__(\n        self,\n        models: List[BaseModel],\n        preprocessors: List[BaseProcessor] = [],\n        postprocessors: List[BaseProcessor] = [],\n        copy_first=True,\n        standardize=True,\n        pipeline_name: str = None,\n    ):\n        self.pipeline_name = pipeline_name if pipeline_name else uuid.uuid4().hex\n        self.models = models\n        self.copy_first = copy_first\n        self.standardize = standardize\n        self.preprocessors = preprocessors\n        self.postprocessors = postprocessors\n\n    def preprocess(self, dataset: Dataset) -> Dataset:\n        if self.copy_first:\n            dataset = CopyPreProcessor()(dataset)\n        for preprocessor in tqdm(\n            self.preprocessors, desc=f\"{self.pipeline_name} Preprocessing:\", position=0\n        ):\n            rich_print(\n                f\":construction: Applying preprocessing: '[bold]{preprocessor.__class__.__name__}[/bold]' :construction:\"\n            )\n            dataset = preprocessor(dataset)\n        return dataset\n\n    def postprocess(self, dataset: Dataset) -> Dataset:\n        if self.standardize:\n            dataset = Standardizer()(dataset)\n        for postprocessor in tqdm(\n            self.postprocessors,\n            desc=f\"{self.pipeline_name} Postprocessing: \",\n            position=0,\n        ):\n            rich_print(\n                f\":construction: Applying postprocessing: '[bold]{postprocessor.__class__.__name__}[/bold]' :construction:\"\n            )\n            dataset = postprocessor(dataset)\n        return dataset\n\n    def process_models(self, dataset: Dataset) -> Dataset:\n        for model in tqdm(\n            self.models, desc=f\"{self.pipeline_name} Model prediction: \", position=0\n        ):\n            rich_print(\n                f\":robot: Generating model predictions with '[bold]{model.__class__.__name__}[/bold]'. :robot:\"\n            )\n            dataset = model(dataset)\n        return dataset\n\n    def pipeline(self, dataset: Dataset) -> Dataset:\n        \"\"\"Process full pipeline and return resulting Dataset.\"\"\"\n        preprocessed_dataset = self.preprocess(dataset)\n        prediction_dataset = self.process_models(preprocessed_dataset)\n        processed_prediction_dataset = self.postprocess(prediction_dataset)\n        rich_print(\n            f\":checkered_flag: [green]Finished pipeline:[green] [bold blue]'{self.pipeline_name}'[bold blue]! :checkered_flag:\"\n        )\n        return processed_prediction_dataset\n\n    def __call__(self, dataset: Dataset):\n        return self.pipeline(dataset)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;test_0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;test_0.8&quot;</span><span class="p">]</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="s2">&quot;test_assets/mini_numerai_version_1_data.csv&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">preprocessors</span> <span class="o">=</span> <span class="p">[</span><span class="n">GroupStatsPreProcessor</span><span class="p">(),</span> <span class="n">FeatureSelectionPreProcessor</span><span class="p">(</span><span class="n">feature_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature_intelligence_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_intelligence_std&#39;</span><span class="p">])]</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">ConstantModel</span><span class="p">(</span><span class="n">constant</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ConstantModel</span><span class="p">(</span><span class="n">constant</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">postprocessors</span> <span class="o">=</span> <span class="p">[</span><span class="n">MeanEnsembler</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;prediction_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">],</span> <span class="n">final_col_name</span><span class="o">=</span><span class="s1">&#39;prediction_ensembled&#39;</span><span class="p">),</span>
                  <span class="n">FeatureNeutralizer</span><span class="p">(</span><span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;feature_intelligence_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_intelligence_std&#39;</span><span class="p">],</span>
                                     <span class="n">pred_name</span><span class="o">=</span><span class="s1">&#39;prediction_ensembled&#39;</span><span class="p">,</span> <span class="n">proportion</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="b2c659ea-2ead-4eb7-97df-24e68335e4f4"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b2c659ea-2ead-4eb7-97df-24e68335e4f4');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# Example using several preprocessor, dummy models and postprocessors\nmodel_names = [\"test_0.5\", \"test_0.8\"]\n\ndataset = create_dataset(\"test_assets/mini_numerai_version_1_data.csv\", version=1)\npreprocessors = [GroupStatsPreProcessor(), FeatureSelectionPreProcessor(feature_cols=['feature_intelligence_mean', 'feature_intelligence_std'])]\nmodels = [ConstantModel(constant=0.5, model_name=model_names[0]), ConstantModel(constant=0.8, model_name=model_names[1])]\npostprocessors = [MeanEnsembler(cols=[f\"prediction_{name}\" for name in model_names], final_col_name='prediction_ensembled'),\n                  FeatureNeutralizer(feature_names=['feature_intelligence_mean', 'feature_intelligence_std'],\n                                     pred_name='prediction_ensembled', proportion=0.8)]";
                var nbb_formatted_code = "# Example using several preprocessor, dummy models and postprocessors\nmodel_names = [\"test_0.5\", \"test_0.8\"]\n\ndataset = create_dataset(\"test_assets/mini_numerai_version_1_data.csv\", version=1)\npreprocessors = [\n    GroupStatsPreProcessor(),\n    FeatureSelectionPreProcessor(\n        feature_cols=[\"feature_intelligence_mean\", \"feature_intelligence_std\"]\n    ),\n]\nmodels = [\n    ConstantModel(constant=0.5, model_name=model_names[0]),\n    ConstantModel(constant=0.8, model_name=model_names[1]),\n]\npostprocessors = [\n    MeanEnsembler(\n        cols=[f\"prediction_{name}\" for name in model_names],\n        final_col_name=\"prediction_ensembled\",\n    ),\n    FeatureNeutralizer(\n        feature_names=[\"feature_intelligence_mean\", \"feature_intelligence_std\"],\n        pred_name=\"prediction_ensembled\",\n        proportion=0.8,\n    ),\n]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_pipeline</span> <span class="o">=</span> <span class="n">ModelPipeline</span><span class="p">(</span><span class="n">preprocessors</span><span class="o">=</span><span class="n">preprocessors</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="n">models</span><span class="p">,</span>
                              <span class="n">postprocessors</span><span class="o">=</span><span class="n">postprocessors</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;test_pipeline&quot;</span><span class="p">,</span>
                              <span class="n">standardize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">processed_dataset</span> <span class="o">=</span> <span class="n">test_pipeline</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">CopyPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">314</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">000718</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying preprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">GroupStatsPreProcessor</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">GroupStatsPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">332</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">025957</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying preprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">FeatureSelectionPreProcessor</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">FeatureSelectionPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">000988</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Generating model predictions with <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ConstantModel</span><span style="color: #008000; text-decoration-color: #008000">'</span>. 🤖
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Generating model predictions with <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ConstantModel</span><span style="color: #008000; text-decoration-color: #008000">'</span>. 🤖
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying postprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">MeanEnsembler</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🍲 Ensembled <span style="color: #000080; text-decoration-color: #000080">'['</span><span style="color: #000080; text-decoration-color: #000080">prediction_test_0.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">5</span><span style="color: #000080; text-decoration-color: #000080">', </span><span style="color: #000080; text-decoration-color: #000080">'prediction_test_0.8'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">]</span><span style="color: #000080; text-decoration-color: #000080">' with simple mean and saved in </span>
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">prediction_ensembled' 🍲</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">MeanEnsembler</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span><span style="font-weight: bold">)</span>. Time taken for step: <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">003493</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying postprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">FeatureNeutralizer</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Neutralized <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'prediction_ensembled'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold"> with proportion </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'0.8'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold"> 🤖</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">New neutralized column = <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">'prediction_ensembled_neutralized_0.8'</span>.
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">FeatureNeutralizer</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">011991</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🏁 <span style="color: #008000; text-decoration-color: #008000">Finished pipeline: </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'test_pipeline'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">! 🏁</span>
</pre>

</div>

</div>

<div class="output_area">




<div id="876d4ad6-daa3-4604-b530-d5eb76549f77"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#876d4ad6-daa3-4604-b530-d5eb76549f77');

            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "test_pipeline = ModelPipeline(preprocessors=preprocessors, models=models,\n                              postprocessors=postprocessors, pipeline_name=\"test_pipeline\",\n                              standardize=False)\nprocessed_dataset = test_pipeline(dataset)";
                var nbb_formatted_code = "test_pipeline = ModelPipeline(\n    preprocessors=preprocessors,\n    models=models,\n    postprocessors=postprocessors,\n    pipeline_name=\"test_pipeline\",\n    standardize=False,\n)\nprocessed_dataset = test_pipeline(dataset)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed_dataset</span><span class="o">.</span><span class="n">dataf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_intelligence_mean</th>
      <th>feature_intelligence_std</th>
      <th>target</th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
      <th>prediction_test_0.5</th>
      <th>prediction_test_0.8</th>
      <th>prediction_ensembled</th>
      <th>prediction_ensembled_neutralized_0.8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.333333</td>
      <td>0.246183</td>
      <td>0.50</td>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.208333</td>
      <td>0.234359</td>
      <td>0.25</td>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.360880</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.479167</td>
      <td>0.327843</td>
      <td>0.25</td>
      <td>n001c93979ac41d4</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.350519</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.416667</td>
      <td>0.288675</td>
      <td>0.25</td>
      <td>n0034e4143f22a13</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.450910</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.270833</td>
      <td>0.128732</td>
      <td>0.75</td>
      <td>n00679d1a636062f</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.378539</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.500000</td>
      <td>0.213201</td>
      <td>0.50</td>
      <td>n009aa2d32389eca</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.361540</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.604167</td>
      <td>0.391070</td>
      <td>0.25</td>
      <td>n009ef1a5fe009b6</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.719895</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.770833</td>
      <td>0.270906</td>
      <td>0.25</td>
      <td>n00ae5d51f55fb0f</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.339932</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.625000</td>
      <td>0.291937</td>
      <td>0.50</td>
      <td>n00b0ac86d77aed7</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.710710</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.562500</td>
      <td>0.284545</td>
      <td>0.75</td>
      <td>n00c63366aeaf76a</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="e0276f62-965d-46d9-9ccd-6a929c252315"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e0276f62-965d-46d9-9ccd-6a929c252315');

            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "processed_dataset.dataf";
                var nbb_formatted_code = "processed_dataset.dataf";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-ModelPipelineCollection">2. ModelPipelineCollection<a class="anchor-link" href="#2.-ModelPipelineCollection"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerai_blocks/modelpipeline.html#ModelPipelineCollection"><code>ModelPipelineCollection</code></a> can be used to easily manage and run multiple <a href="/numerai_blocks/modelpipeline.html#ModelPipeline"><code>ModelPipeline</code></a> objects.</p>
<p>TODO: Add multiprocessing support.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ModelPipelineCollection" class="doc_header"><code>class</code> <code>ModelPipelineCollection</code><a href="https://github.com/crowdcent/numerai_blocks/tree/main/numerai_blocks/model_pipeline.py#L85" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ModelPipelineCollection</code>(<strong><code>pipelines</code></strong>:<code>List</code>[<a href="/numerai_blocks/modelpipeline.html#ModelPipeline"><code>ModelPipeline</code></a>])</p>
</blockquote>
<p>Execute multiple initialized ModelPipelines in a sequence.
:param pipelines: List of initialized ModelPipelines.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="d60f25b1-cf3b-4374-8588-63387b8e62dd"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d60f25b1-cf3b-4374-8588-63387b8e62dd');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "#export\n@typechecked\nclass ModelPipelineCollection:\n    \"\"\"\n    Execute multiple initialized ModelPipelines in a sequence.\n    :param pipelines: List of initialized ModelPipelines.\n    \"\"\"\n    def __init__(self, pipelines: List[ModelPipeline]):\n        self.pipelines = {pipe.pipeline_name: pipe for pipe in pipelines}\n        self.pipeline_names = list(self.pipelines.keys())\n\n    def process_all_pipelines(self, dataset: Dataset) -> List[Dataset]:\n        \"\"\" Process all pipelines and return list of resulting Datasets. \"\"\"\n        result_datasets = []\n        for name, pipeline in tqdm(self.pipelines.items(),\n                                   desc=\"Processing Pipeline Collection\"):\n            result_datasets.append(self.process_single_pipeline(dataset, name))\n        return result_datasets\n\n    def process_single_pipeline(self, dataset: Dataset, pipeline_name: str) -> Dataset:\n        rich_print(f\":construction_worker: [bold green]Processing model pipeline:[/bold green] '{pipeline_name}' :construction_worker:\")\n        pipeline = self.get_pipeline(pipeline_name)\n        dataset = pipeline(dataset)\n        return dataset\n\n    def get_pipeline(self, pipeline_name: str) -> ModelPipeline:\n        available_pipelines = self.pipeline_names\n        assert pipeline_name in available_pipelines, f\"Requested pipeline '{pipeline_name}', but only the following models are in the collection: '{available_pipelines}'.\"\n        return self.pipelines[pipeline_name]\n\n    def __call__(self, dataset: Dataset) -> List[Dataset]:\n        return self.process_all_pipelines(dataset=dataset)";
                var nbb_formatted_code = "# export\n@typechecked\nclass ModelPipelineCollection:\n    \"\"\"\n    Execute multiple initialized ModelPipelines in a sequence.\n    :param pipelines: List of initialized ModelPipelines.\n    \"\"\"\n\n    def __init__(self, pipelines: List[ModelPipeline]):\n        self.pipelines = {pipe.pipeline_name: pipe for pipe in pipelines}\n        self.pipeline_names = list(self.pipelines.keys())\n\n    def process_all_pipelines(self, dataset: Dataset) -> List[Dataset]:\n        \"\"\"Process all pipelines and return list of resulting Datasets.\"\"\"\n        result_datasets = []\n        for name, pipeline in tqdm(\n            self.pipelines.items(), desc=\"Processing Pipeline Collection\"\n        ):\n            result_datasets.append(self.process_single_pipeline(dataset, name))\n        return result_datasets\n\n    def process_single_pipeline(self, dataset: Dataset, pipeline_name: str) -> Dataset:\n        rich_print(\n            f\":construction_worker: [bold green]Processing model pipeline:[/bold green] '{pipeline_name}' :construction_worker:\"\n        )\n        pipeline = self.get_pipeline(pipeline_name)\n        dataset = pipeline(dataset)\n        return dataset\n\n    def get_pipeline(self, pipeline_name: str) -> ModelPipeline:\n        available_pipelines = self.pipeline_names\n        assert (\n            pipeline_name in available_pipelines\n        ), f\"Requested pipeline '{pipeline_name}', but only the following models are in the collection: '{available_pipelines}'.\"\n        return self.pipelines[pipeline_name]\n\n    def __call__(self, dataset: Dataset) -> List[Dataset]:\n        return self.process_all_pipelines(dataset=dataset)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_pipeline2</span> <span class="o">=</span> <span class="n">ModelPipeline</span><span class="p">(</span><span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">RandomModel</span><span class="p">()],</span> <span class="n">pipeline_name</span><span class="o">=</span><span class="s2">&quot;test_pipeline2&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="c9dccfde-f98d-4670-b69e-6e1d4af2777e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c9dccfde-f98d-4670-b69e-6e1d4af2777e');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "# Different pipeline with no preprocessing or postprocessing. Only RandomModel\ntest_pipeline2 = ModelPipeline(models=[RandomModel()], pipeline_name=\"test_pipeline2\")";
                var nbb_formatted_code = "# Different pipeline with no preprocessing or postprocessing. Only RandomModel\ntest_pipeline2 = ModelPipeline(models=[RandomModel()], pipeline_name=\"test_pipeline2\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">collection</span> <span class="o">=</span> <span class="n">ModelPipelineCollection</span><span class="p">([</span><span class="n">test_pipeline</span><span class="p">,</span> <span class="n">test_pipeline2</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_pipeline</span><span class="p">(</span><span class="s2">&quot;test_pipeline2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pipeline_name</span> <span class="o">==</span> <span class="s1">&#39;test_pipeline2&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="0ca20065-c752-4411-a3e8-f4f20c9eb3cb"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#0ca20065-c752-4411-a3e8-f4f20c9eb3cb');

            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "collection = ModelPipelineCollection([test_pipeline, test_pipeline2])\nassert collection.get_pipeline(\"test_pipeline2\").pipeline_name == 'test_pipeline2'";
                var nbb_formatted_code = "collection = ModelPipelineCollection([test_pipeline, test_pipeline2])\nassert collection.get_pipeline(\"test_pipeline2\").pipeline_name == \"test_pipeline2\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result_datasets</span> <span class="o">=</span> <span class="n">collection</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">👷 <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">Processing model pipeline:</span> <span style="color: #008000; text-decoration-color: #008000">'test_pipeline'</span> 👷
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">CopyPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">314</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">000621</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying preprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">GroupStatsPreProcessor</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">GroupStatsPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">332</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">030400</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying preprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">FeatureSelectionPreProcessor</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">FeatureSelectionPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">000946</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Generating model predictions with <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ConstantModel</span><span style="color: #008000; text-decoration-color: #008000">'</span>. 🤖
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Generating model predictions with <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">ConstantModel</span><span style="color: #008000; text-decoration-color: #008000">'</span>. 🤖
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying postprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">MeanEnsembler</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🍲 Ensembled <span style="color: #000080; text-decoration-color: #000080">'['</span><span style="color: #000080; text-decoration-color: #000080">prediction_test_0.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">5</span><span style="color: #000080; text-decoration-color: #000080">', </span><span style="color: #000080; text-decoration-color: #000080">'prediction_test_0.8'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">]</span><span style="color: #000080; text-decoration-color: #000080">' with simple mean and saved in </span>
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">prediction_ensembled' 🍲</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">MeanEnsembler</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span><span style="font-weight: bold">)</span>. Time taken for step: <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">003080</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🚧 Applying postprocessing: <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">FeatureNeutralizer</span><span style="color: #008000; text-decoration-color: #008000">'</span> 🚧
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Neutralized <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'prediction_ensembled'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold"> with proportion </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'0.8'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold"> 🤖</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">New neutralized column = <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">'prediction_ensembled_neutralized_0.8'</span>.
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">FeatureNeutralizer</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">011458</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🏁 <span style="color: #008000; text-decoration-color: #008000">Finished pipeline: </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'test_pipeline'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">! 🏁</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">👷 <span style="color: #008000; text-decoration-color: #008000; font-weight: bold">Processing model pipeline:</span> <span style="color: #008000; text-decoration-color: #008000">'test_pipeline2'</span> 👷
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">CopyPreProcessor</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">314</span><span style="font-weight: bold">)</span>. Time taken for step: 
<span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">000648</span>. ✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🤖 Generating model predictions with <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #008000; text-decoration-color: #008000; font-weight: bold">RandomModel</span><span style="color: #008000; text-decoration-color: #008000">'</span>. 🤖
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">✅ Finished step <span style="font-weight: bold">Standardizer</span>. Output <span style="color: #808000; text-decoration-color: #808000">shape</span>=<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">10</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">315</span><span style="font-weight: bold">)</span>. Time taken for step: <span style="color: #000080; text-decoration-color: #000080; font-weight: bold">0:00:00</span><span style="color: #000080; text-decoration-color: #000080">.</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">004731</span>. 
✅
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">🏁 <span style="color: #008000; text-decoration-color: #008000">Finished pipeline: </span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">'test_pipeline2'</span><span style="color: #000080; text-decoration-color: #000080; font-weight: bold">! 🏁</span>
</pre>

</div>

</div>

<div class="output_area">




<div id="b62f4a7b-13fc-45f8-92b5-b99d73c08f6b"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b62f4a7b-13fc-45f8-92b5-b99d73c08f6b');

            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "result_datasets = collection(dataset=dataset)";
                var nbb_formatted_code = "result_datasets = collection(dataset=dataset)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/numerai_blocks/modelpipeline.html#ModelPipelineCollection"><code>ModelPipelineCollection</code></a> return a list of <a href="/numerai_blocks/dataset.html#Dataset"><code>Dataset</code></a> objects, retaining all metadata and adding prediction columns for each. Note that the 1st <a href="/numerai_blocks/dataset.html#Dataset"><code>Dataset</code></a> had a feature selection step, so it did not retain all columns. However, the second dataset retained all feature columns, because it did not have a feature selection step.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dataf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_intelligence_mean</th>
      <th>feature_intelligence_std</th>
      <th>target</th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
      <th>prediction_test_0.5</th>
      <th>prediction_test_0.8</th>
      <th>prediction_ensembled</th>
      <th>prediction_ensembled_neutralized_0.8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.333333</td>
      <td>0.246183</td>
      <td>0.50</td>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.208333</td>
      <td>0.234359</td>
      <td>0.25</td>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.360880</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.479167</td>
      <td>0.327843</td>
      <td>0.25</td>
      <td>n001c93979ac41d4</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.350519</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.416667</td>
      <td>0.288675</td>
      <td>0.25</td>
      <td>n0034e4143f22a13</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.450910</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.270833</td>
      <td>0.128732</td>
      <td>0.75</td>
      <td>n00679d1a636062f</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.378539</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.500000</td>
      <td>0.213201</td>
      <td>0.50</td>
      <td>n009aa2d32389eca</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.361540</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.604167</td>
      <td>0.391070</td>
      <td>0.25</td>
      <td>n009ef1a5fe009b6</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.719895</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.770833</td>
      <td>0.270906</td>
      <td>0.25</td>
      <td>n00ae5d51f55fb0f</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.339932</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.625000</td>
      <td>0.291937</td>
      <td>0.50</td>
      <td>n00b0ac86d77aed7</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.710710</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.562500</td>
      <td>0.284545</td>
      <td>0.75</td>
      <td>n00c63366aeaf76a</td>
      <td>era1</td>
      <td>train</td>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="ce97868c-768f-4781-9dad-853fec31a42c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#ce97868c-768f-4781-9dad-853fec31a42c');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "result_datasets[0].dataf";
                var nbb_formatted_code = "result_datasets[0].dataf";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result_datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dataf</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>...</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
      <th>target</th>
      <th>prediction_random</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>...</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>n001c93979ac41d4</td>
      <td>era1</td>
      <td>train</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>0.50</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>n0034e4143f22a13</td>
      <td>era1</td>
      <td>train</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>...</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>n00679d1a636062f</td>
      <td>era1</td>
      <td>train</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>n009aa2d32389eca</td>
      <td>era1</td>
      <td>train</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>0.75</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>n009ef1a5fe009b6</td>
      <td>era1</td>
      <td>train</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>...</td>
      <td>1.00</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>n00ae5d51f55fb0f</td>
      <td>era1</td>
      <td>train</td>
      <td>0.25</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>n00b0ac86d77aed7</td>
      <td>era1</td>
      <td>train</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.50</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>n00c63366aeaf76a</td>
      <td>era1</td>
      <td>train</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>...</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 315 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="cf2ce396-0470-44d9-a717-bfee1f682fc1"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#cf2ce396-0470-44d9-a717-bfee1f682fc1');

            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "result_datasets[1].dataf";
                var nbb_formatted_code = "result_datasets[1].dataf";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that multiple resulting <a href="/numerai_blocks/dataset.html#Dataset"><code>Dataset</code></a> objects can be merged. Convenient for ensembling applications based on multiple pipelines.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">combined_dataset</span> <span class="o">=</span> <span class="n">result_datasets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">merge_datasets</span><span class="p">(</span><span class="n">result_datasets</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="n">combined_dataset</span><span class="o">.</span><span class="n">get_prediction_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">⚠ <span style="color: #800000; text-decoration-color: #800000; font-weight: bold">Warning</span>: No <span style="color: #008000; text-decoration-color: #008000">'era'</span> column found in DataFrame. <span style="color: #008000; text-decoration-color: #008000">'era'</span> column is mandatory for certain 
numerai-blocks functionality. ⚠
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>prediction_test_0.5</th>
      <th>prediction_test_0.8</th>
      <th>prediction_ensembled</th>
      <th>prediction_ensembled_neutralized_0.8</th>
      <th>prediction_random</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.000000</td>
      <td>0.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.360880</td>
      <td>0.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.350519</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.450910</td>
      <td>0.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.378539</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.361540</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.719895</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.339932</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>0.710710</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.5</td>
      <td>0.8</td>
      <td>0.65</td>
      <td>1.000000</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="7ba9e0b7-1d49-4bc2-a676-f1f2a987b4a2"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7ba9e0b7-1d49-4bc2-a676-f1f2a987b4a2');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "combined_dataset = result_datasets[0].merge_datasets(result_datasets[1], on='id', how='outer')\ncombined_dataset.get_prediction_data";
                var nbb_formatted_code = "combined_dataset = result_datasets[0].merge_datasets(\n    result_datasets[1], on=\"id\", how=\"outer\"\n)\ncombined_dataset.get_prediction_data";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>
 

