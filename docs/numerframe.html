---

title: NumerFrame


keywords: fastai
sidebar: home_sidebar

summary: "Custom data structure for Numerai data. Extends Pandas DataFrame."
description: "Custom data structure for Numerai data. Extends Pandas DataFrame."
nb_path: "nbs/02_numerframe.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_numerframe.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview:-The-NumerFrame">Overview: The NumerFrame<a class="anchor-link" href="#Overview:-The-NumerFrame"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a> is a data structure that extends <code>pd.DataFrame</code> with functionality convenient for Numerai users. The main benefits include:</p>
<ol>
<li>Automatically track features, targets, prediction and other columns + easily retrieve these data slices.</li>
<li>Add, export and import metadata. Furthermore, dynamically update or manipulate metadata within your Numerai data pipeline.</li>
<li>Other library functionality automatically recognizes era column (<code>era</code> or <code>friday_date</code>).</li>
<li>Integrations with other library components (i.e. <code>preprocessing</code>, <code>model</code>, <code>modelpipeline</code>, <code>postprocessing</code>, <code>evaluation</code> and <code>submission</code>) to create more solid and increase reliability of Numerai inference pipelines.</li>
</ol>
<p>Besides, all functionality of Pandas DataFrames is still available in the <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a>. You therefore don't have to create new pipelines to process your data when using <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We adopt the convention:</p>
<ol>
<li>All feature column names should start with <code>'feature'</code>.</li>
<li>All target column names should start with <code>'target'</code>.</li>
<li>All prediction column names should start with <code>'prediction'</code>.</li>
<li>Data should contain an <code>'era'</code> or <code>'friday_date'</code> column, as is almost always the case with Numerai datasets.</li>
</ol>
<p>Every column for which these conditions do not hold will be classified as an <code>'aux'</code> column.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NumerFrame" class="doc_header"><code>class</code> <code>NumerFrame</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/numerframe.py#L19" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NumerFrame</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>DataFrame</code></p>
</blockquote>
<p>Data structure which extends Pandas DataFrames and
allows for additional Numerai specific functionality.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="05eccb30-2d57-47dc-bef0-488e1e3f4072"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#05eccb30-2d57-47dc-bef0-488e1e3f4072');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "# export\nclass NumerFrame(pd.DataFrame):\n    \"\"\"\n    Data structure which extends Pandas DataFrames and\n    allows for additional Numerai specific functionality.\n    \"\"\"\n    _metadata = [\"meta\", \"feature_cols\", \"target_cols\",\n                 \"prediction_cols\", \"not_aux_cols\", \"aux_cols\"]\n    meta = AttrDict()\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.__init_meta_attrs()\n        if not \"era_col_verified\" in self.meta:\n            self.__set_era_col()\n\n    @property\n    def _constructor(self):\n        return NumerFrame\n\n    def __init_meta_attrs(self):\n        \"\"\" Dynamically track column groups. \"\"\"\n        self.feature_cols = [col for col in self.columns if str(col).startswith(\"feature\")]\n        self.target_cols = [col for col in self.columns if str(col).startswith(\"target\")]\n        self.prediction_cols = [\n            col for col in self.columns if str(col).startswith(\"prediction\")\n        ]\n        self.not_aux_cols = self.feature_cols + self.target_cols + self.prediction_cols\n        self.aux_cols = [\n            col for col in self.columns if col not in self.not_aux_cols\n        ]\n\n    def __set_era_col(self):\n        \"\"\" Each NumerFrame should have an era column to benefit from all functionality. \"\"\"\n        if \"era\" in self.columns:\n            self.meta.era_col = \"era\"\n        elif \"friday_date\" in self.columns:\n            self.meta.era_col = \"friday_date\"\n        else:\n            raise AttributeError(\"NumerFrame must contain either an 'era' or 'friday_date' column.\")\n        self.meta.era_col_verified = True\n\n    def add_metadata(self, *args, **kwargs):\n        \"\"\" Parse arbitrary metadata (i.e. Python objects) to the meta attribute. \"\"\"\n        self.meta.update(*args, **kwargs)\n\n    def export_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Export all attributes in NumerFrame that can be serialized to json file.\"\"\"\n        rich_print(f\":file_folder: Exporting metadata to {file} :file_folder:\")\n        json_txt = json.dumps(\n            self.meta.__dict__, default=lambda o: \"<not serializable>\", **kwargs\n        )\n        if verbose:\n            rich_print(json_txt)\n        Path(file).write_text(json_txt)\n\n    def import_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Load arbitrary data into NumerFrame object from json file.\"\"\"\n        rich_print(f\":file_folder: Importing metadata from {file} :file_folder:\")\n        with open(file) as json_file:\n            json_data = json.load(json_file, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        self.meta.__dict__.update(json_data)\n\n    def get_column_selection(self, cols: Union[str, list]):\n        \"\"\" Return NumerFrame from selection of columns. \"\"\"\n        return self.loc[:, cols if isinstance(cols, list) else [cols]]\n\n    @property\n    def get_feature_data(self):\n        \"\"\" All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.feature_cols)\n\n    @property\n    def get_target_data(self):\n        \"\"\" All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.target_cols)\n\n    @property\n    def get_single_target_data(self):\n        \"\"\" Column with name 'target' (Main Numerai target column). \"\"\"\n        return self.get_column_selection(cols=['target'])\n\n    @property\n    def get_prediction_data(self):\n        \"\"\" All columns for which name starts with 'prediction'.\"\"\"\n        return self.get_column_selection(cols=self.prediction_cols)\n\n    @property\n    def get_aux_data(self):\n        \"\"\" All columns that are not features, targets or predictions. \"\"\"\n        return self.get_column_selection(cols=self.aux_cols)\n\n    def get_feature_target_pair(self, multi_target=False) -> Tuple[Any, Any]:\n        \"\"\"\n        Get split of feature and target columns.\n        :param multi_target: Returns only 'target' column by default.\n        Returns all target columns when set to True.\n        \"\"\"\n        X = self.get_feature_data\n        y = self.get_target_data if multi_target else self.get_single_target_data\n        return X, y\n\n    def get_era_batch(self, eras: List[Any],\n                      convert_to_tf = False,\n                      aemlp_batch = False,\n                      features: list = None,\n                      targets: list = None,\n                      *args, **kwargs) -> tuple:\n        \"\"\"\n        Get feature target pair batch of 1 or multiple eras. \\n\n        :param eras: Selection of era names that should be present in era_col. \\n\n        :param convert_to_tf: Convert to tf.Tensor. \\n\n        :param aemlp_batch: Specific target batch for autoencoder training. \\n\n        `y` output will contain three components: features, targets and targets. \\n\n        :param features: List of features to select. All by default \\n\n        :param targets: List of targets to select. All by default. \\n\n        *args, **kwargs are passed to initialization of Tensor.\n        \"\"\"\n        valid_eras = []\n        for era in eras:\n            assert era in self[self.meta.era_col].unique(), f\"Era '{era}' not found in era column ({self.meta.era_col})\"\n            valid_eras.append(era)\n        features = features if features else self.feature_cols\n        targets = targets if targets else self.target_cols\n        X = self.loc[self[self.meta.era_col].isin(valid_eras)][features].values\n        y = self.loc[self[self.meta.era_col].isin(valid_eras)][targets].values\n        if aemlp_batch:\n            y = [X.copy(), y.copy(), y.copy()]\n\n        if convert_to_tf:\n            X = tf.convert_to_tensor(X, *args, **kwargs)\n            if aemlp_batch:\n                y = [tf.convert_to_tensor(i, *args, **kwargs) for i in y]\n            else:\n                y = tf.convert_to_tensor(y, *args, **kwargs)\n        return X, y\n\n    def profile_report(self, *args, **kwargs) -> ProfileReport:\n        \"\"\"\n        DataFrame profiling. Might take a while to generate for large datasets.\n        For more info: https://pandas-profiling.github.io/pandas-profiling/docs/master/index.html\n        *args, **kwargs will be passed to ProfileReport initialization.\n        \"\"\"\n        return ProfileReport(self, *args, **kwargs)";
                var nbb_formatted_code = "# export\nclass NumerFrame(pd.DataFrame):\n    \"\"\"\n    Data structure which extends Pandas DataFrames and\n    allows for additional Numerai specific functionality.\n    \"\"\"\n\n    _metadata = [\n        \"meta\",\n        \"feature_cols\",\n        \"target_cols\",\n        \"prediction_cols\",\n        \"not_aux_cols\",\n        \"aux_cols\",\n    ]\n    meta = AttrDict()\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.__init_meta_attrs()\n        if not \"era_col_verified\" in self.meta:\n            self.__set_era_col()\n\n    @property\n    def _constructor(self):\n        return NumerFrame\n\n    def __init_meta_attrs(self):\n        \"\"\"Dynamically track column groups.\"\"\"\n        self.feature_cols = [\n            col for col in self.columns if str(col).startswith(\"feature\")\n        ]\n        self.target_cols = [\n            col for col in self.columns if str(col).startswith(\"target\")\n        ]\n        self.prediction_cols = [\n            col for col in self.columns if str(col).startswith(\"prediction\")\n        ]\n        self.not_aux_cols = self.feature_cols + self.target_cols + self.prediction_cols\n        self.aux_cols = [col for col in self.columns if col not in self.not_aux_cols]\n\n    def __set_era_col(self):\n        \"\"\"Each NumerFrame should have an era column to benefit from all functionality.\"\"\"\n        if \"era\" in self.columns:\n            self.meta.era_col = \"era\"\n        elif \"friday_date\" in self.columns:\n            self.meta.era_col = \"friday_date\"\n        else:\n            raise AttributeError(\n                \"NumerFrame must contain either an 'era' or 'friday_date' column.\"\n            )\n        self.meta.era_col_verified = True\n\n    def add_metadata(self, *args, **kwargs):\n        \"\"\"Parse arbitrary metadata (i.e. Python objects) to the meta attribute.\"\"\"\n        self.meta.update(*args, **kwargs)\n\n    def export_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Export all attributes in NumerFrame that can be serialized to json file.\"\"\"\n        rich_print(f\":file_folder: Exporting metadata to {file} :file_folder:\")\n        json_txt = json.dumps(\n            self.meta.__dict__, default=lambda o: \"<not serializable>\", **kwargs\n        )\n        if verbose:\n            rich_print(json_txt)\n        Path(file).write_text(json_txt)\n\n    def import_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Load arbitrary data into NumerFrame object from json file.\"\"\"\n        rich_print(f\":file_folder: Importing metadata from {file} :file_folder:\")\n        with open(file) as json_file:\n            json_data = json.load(json_file, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        self.meta.__dict__.update(json_data)\n\n    def get_column_selection(self, cols: Union[str, list]):\n        \"\"\"Return NumerFrame from selection of columns.\"\"\"\n        return self.loc[:, cols if isinstance(cols, list) else [cols]]\n\n    @property\n    def get_feature_data(self):\n        \"\"\"All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.feature_cols)\n\n    @property\n    def get_target_data(self):\n        \"\"\"All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.target_cols)\n\n    @property\n    def get_single_target_data(self):\n        \"\"\"Column with name 'target' (Main Numerai target column).\"\"\"\n        return self.get_column_selection(cols=[\"target\"])\n\n    @property\n    def get_prediction_data(self):\n        \"\"\"All columns for which name starts with 'prediction'.\"\"\"\n        return self.get_column_selection(cols=self.prediction_cols)\n\n    @property\n    def get_aux_data(self):\n        \"\"\"All columns that are not features, targets or predictions.\"\"\"\n        return self.get_column_selection(cols=self.aux_cols)\n\n    def get_feature_target_pair(self, multi_target=False) -> Tuple[Any, Any]:\n        \"\"\"\n        Get split of feature and target columns.\n        :param multi_target: Returns only 'target' column by default.\n        Returns all target columns when set to True.\n        \"\"\"\n        X = self.get_feature_data\n        y = self.get_target_data if multi_target else self.get_single_target_data\n        return X, y\n\n    def get_era_batch(\n        self,\n        eras: List[Any],\n        convert_to_tf=False,\n        aemlp_batch=False,\n        features: list = None,\n        targets: list = None,\n        *args,\n        **kwargs,\n    ) -> tuple:\n        \"\"\"\n        Get feature target pair batch of 1 or multiple eras. \\n\n        :param eras: Selection of era names that should be present in era_col. \\n\n        :param convert_to_tf: Convert to tf.Tensor. \\n\n        :param aemlp_batch: Specific target batch for autoencoder training. \\n\n        `y` output will contain three components: features, targets and targets. \\n\n        :param features: List of features to select. All by default \\n\n        :param targets: List of targets to select. All by default. \\n\n        *args, **kwargs are passed to initialization of Tensor.\n        \"\"\"\n        valid_eras = []\n        for era in eras:\n            assert (\n                era in self[self.meta.era_col].unique()\n            ), f\"Era '{era}' not found in era column ({self.meta.era_col})\"\n            valid_eras.append(era)\n        features = features if features else self.feature_cols\n        targets = targets if targets else self.target_cols\n        X = self.loc[self[self.meta.era_col].isin(valid_eras)][features].values\n        y = self.loc[self[self.meta.era_col].isin(valid_eras)][targets].values\n        if aemlp_batch:\n            y = [X.copy(), y.copy(), y.copy()]\n\n        if convert_to_tf:\n            X = tf.convert_to_tensor(X, *args, **kwargs)\n            if aemlp_batch:\n                y = [tf.convert_to_tensor(i, *args, **kwargs) for i in y]\n            else:\n                y = tf.convert_to_tensor(y, *args, **kwargs)\n        return X, y\n\n    def profile_report(self, *args, **kwargs) -> ProfileReport:\n        \"\"\"\n        DataFrame profiling. Might take a while to generate for large datasets.\n        For more info: https://pandas-profiling.github.io/pandas-profiling/docs/master/index.html\n        *args, **kwargs will be passed to ProfileReport initialization.\n        \"\"\"\n        return ProfileReport(self, *args, **kwargs)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerblox/numerframe.html#create_numerframe"><code>create_numerframe</code></a> automatically recognizes your data file format, loads it into a <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a> and optionally adds metadata to it.</p>
<p>Support file formats are <code>.csv</code>, <code>.parquet</code>, <code>.pkl</code>, <code>.pickle</code>, <code>.json</code>, <code>.xsl</code>, <code>.xslx</code>, <code>.xlsm</code>, <code>.xlsb</code>, <code>.odf</code>, <code>.ods</code> and <code>.odt</code>. If the file format for your use case is missing, feel free to create a Github issue or submit a pull request. See <code>README.md</code> for more information on contributing.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_numerframe" class="doc_header"><code>create_numerframe</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/numerframe.py#L166" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_numerframe</code>(<strong><code>file_path</code></strong>:<code>str</code>, <strong><code>metadata</code></strong>:<code>dict</code>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Convenient function to initialize NumerFrame.
Support most used file formats for Pandas DataFrames (.csv, .parquet, .pkl, .json, .xls, etc.).
For more details check <a href="https://pandas.pydata.org/docs/reference/io.html">https://pandas.pydata.org/docs/reference/io.html</a></p>
<p>:param file_path: Relative or absolute path to data file.</p>
<p>:param metadata: Metadata to be stored in NumerFrame.meta.</p>
<p>*args, **kwargs will be passed to Pandas loading function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="791ed3f1-0878-4b18-8749-7e94605124eb"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#791ed3f1-0878-4b18-8749-7e94605124eb');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "#export\ndef create_numerframe(file_path: str, metadata: dict = None, *args, **kwargs) -> NumerFrame:\n    \"\"\"\n    Convenient function to initialize NumerFrame.\n    Support most used file formats for Pandas DataFrames (.csv, .parquet, .pkl, .json, .xls, etc.).\n    For more details check https://pandas.pydata.org/docs/reference/io.html\n\n    :param file_path: Relative or absolute path to data file. \\n\n    :param metadata: Metadata to be stored in NumerFrame.meta. \\n\n    *args, **kwargs will be passed to Pandas loading function.\n    \"\"\"\n    assert Path(file_path).is_file(), f\"{file_path} does not point to file.\"\n    suffix = Path(file_path).suffix\n    if suffix in [\".csv\"]:\n        dataf = pd.read_csv(file_path, *args, **kwargs)\n    elif suffix in [\".parquet\"]:\n        dataf = pd.read_parquet(file_path, *args, **kwargs)\n    elif suffix in [\".pkl\", \".pickle\"]:\n        dataf = pd.read_pickle(file_path, *args, **kwargs)\n    elif suffix in [\".json\"]:\n        dataf = pd.read_json(file_path, *args, **kwargs)\n    elif suffix in [\".xls\", \".xlsx\", \".xlsm\", \"xlsb\", \".odf\", \".ods\", \".odt\"]:\n        dataf = pd.read_excel(file_path, *args, **kwargs)\n    else:\n        raise NotImplementedError(f\"Suffix '{suffix}' is not supported.\")\n    num_frame = NumerFrame(dataf)\n    if metadata:\n        num_frame.add_metadata(metadata)\n    return num_frame";
                var nbb_formatted_code = "# export\ndef create_numerframe(\n    file_path: str, metadata: dict = None, *args, **kwargs\n) -> NumerFrame:\n    \"\"\"\n    Convenient function to initialize NumerFrame.\n    Support most used file formats for Pandas DataFrames (.csv, .parquet, .pkl, .json, .xls, etc.).\n    For more details check https://pandas.pydata.org/docs/reference/io.html\n\n    :param file_path: Relative or absolute path to data file. \\n\n    :param metadata: Metadata to be stored in NumerFrame.meta. \\n\n    *args, **kwargs will be passed to Pandas loading function.\n    \"\"\"\n    assert Path(file_path).is_file(), f\"{file_path} does not point to file.\"\n    suffix = Path(file_path).suffix\n    if suffix in [\".csv\"]:\n        dataf = pd.read_csv(file_path, *args, **kwargs)\n    elif suffix in [\".parquet\"]:\n        dataf = pd.read_parquet(file_path, *args, **kwargs)\n    elif suffix in [\".pkl\", \".pickle\"]:\n        dataf = pd.read_pickle(file_path, *args, **kwargs)\n    elif suffix in [\".json\"]:\n        dataf = pd.read_json(file_path, *args, **kwargs)\n    elif suffix in [\".xls\", \".xlsx\", \".xlsm\", \"xlsb\", \".odf\", \".ods\", \".odt\"]:\n        dataf = pd.read_excel(file_path, *args, **kwargs)\n    else:\n        raise NotImplementedError(f\"Suffix '{suffix}' is not supported.\")\n    num_frame = NumerFrame(dataf)\n    if metadata:\n        num_frame.add_metadata(metadata)\n    return num_frame";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NumerFrame-Usage">NumerFrame Usage<a class="anchor-link" href="#NumerFrame-Usage"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a> object can be initialized from memory just like you would with a Pandas DataFrame.
You then have the option to add metadata with <code>.add_metadata</code>. All metadata will be stored in the <code>meta</code> attribute.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-Initialize-from-memory">1. Initialize from memory<a class="anchor-link" href="#1.-Initialize-from-memory"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_features</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;feature_</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="s2">&quot;ABCDEFGHIK&quot;</span><span class="p">]</span>
<span class="n">id_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>

<span class="c1"># Random DataFrame</span>
<span class="n">dataf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="n">test_features</span><span class="p">)</span>
<span class="n">dataf</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_col</span>
<span class="n">dataf</span><span class="p">[[</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="s2">&quot;target_1&quot;</span><span class="p">,</span> <span class="s2">&quot;target_2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">dataf</span><span class="p">[</span><span class="s2">&quot;era&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="6eceeb61-ae14-4d52-b39e-7db285d1b56c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#6eceeb61-ae14-4d52-b39e-7db285d1b56c');

            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "test_features = [f\"feature_{l}\" for l in \"ABCDEFGHIK\"]\nid_col = [uuid.uuid4().hex for _ in range(100)]\n\n# Random DataFrame\ndataf = pd.DataFrame(np.random.uniform(size=(100, 10)), columns=test_features)\ndataf[\"id\"] = id_col\ndataf[[\"target\", \"target_1\", \"target_2\"]] = np.random.normal(size=(100, 3))\ndataf[\"era\"] = range(100)";
                var nbb_formatted_code = "test_features = [f\"feature_{l}\" for l in \"ABCDEFGHIK\"]\nid_col = [uuid.uuid4().hex for _ in range(100)]\n\n# Random DataFrame\ndataf = pd.DataFrame(np.random.uniform(size=(100, 10)), columns=test_features)\ndataf[\"id\"] = id_col\ndataf[[\"target\", \"target_1\", \"target_2\"]] = np.random.normal(size=(100, 3))\ndataf[\"era\"] = range(100)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s2">&quot;additional_info&quot;</span><span class="p">:</span> <span class="s2">&quot;test_model&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multi_target&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;tournament_type&quot;</span><span class="p">:</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">memory_dataf</span> <span class="o">=</span> <span class="n">NumerFrame</span><span class="p">(</span><span class="n">dataf</span><span class="p">)</span>
<span class="n">memory_dataf</span><span class="o">.</span><span class="n">add_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">42</span>
<span class="k">assert</span> <span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">tournament_type</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="ded5cd86-9a58-44f2-983e-d767e26eaae6"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#ded5cd86-9a58-44f2-983e-d767e26eaae6');

            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "metadata = {\n    \"version\": 42,\n    \"additional_info\": \"test_model\",\n    \"multi_target\": False,\n    \"tournament_type\": \"random\",\n}\nmemory_dataf = NumerFrame(dataf)\nmemory_dataf.add_metadata(metadata)\nassert memory_dataf.meta.version == 42\nassert memory_dataf.meta.tournament_type == \"random\"";
                var nbb_formatted_code = "metadata = {\n    \"version\": 42,\n    \"additional_info\": \"test_model\",\n    \"multi_target\": False,\n    \"tournament_type\": \"random\",\n}\nmemory_dataf = NumerFrame(dataf)\nmemory_dataf.add_metadata(metadata)\nassert memory_dataf.meta.version == 42\nassert memory_dataf.meta.tournament_type == \"random\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Metadata stored in <code>.meta</code> and can be accessed as a dictionary or as attributes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;era_col&#39;: &#39;era&#39;,
 &#39;era_col_verified&#39;: True,
 &#39;version&#39;: 42,
 &#39;additional_info&#39;: &#39;test_model&#39;,
 &#39;multi_target&#39;: False,
 &#39;tournament_type&#39;: &#39;random&#39;}</pre>
</div>

</div>

<div class="output_area">




<div id="e97661e2-dc95-49ce-ac56-1a90e70be975"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e97661e2-dc95-49ce-ac56-1a90e70be975');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "memory_dataf.meta";
                var nbb_formatted_code = "memory_dataf.meta";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>42</pre>
</div>

</div>

<div class="output_area">




<div id="b5a377ea-51a4-4656-987a-a723cf0f8c2d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b5a377ea-51a4-4656-987a-a723cf0f8c2d');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "memory_dataf.meta.version";
                var nbb_formatted_code = "memory_dataf.meta.version";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>42</pre>
</div>

</div>

<div class="output_area">




<div id="f31d0e33-2965-43ce-8d0b-98cef717927b"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#f31d0e33-2965-43ce-8d0b-98cef717927b');

            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "memory_dataf.meta['version']";
                var nbb_formatted_code = "memory_dataf.meta[\"version\"]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="n">memory_dataf</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="e5a7d108-4b6c-40fa-ab17-651023044ee1"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e5a7d108-4b6c-40fa-ab17-651023044ee1');

            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "assert memory_dataf.meta.version == memory_dataf.meta['version']";
                var nbb_formatted_code = "assert memory_dataf.meta.version == memory_dataf.meta[\"version\"]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Initialize-from-file-path">2. Initialize from file path<a class="anchor-link" href="#2.-Initialize-from-file-path"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can also use the convenience function <a href="/numerblox/numerframe.html#create_numerframe"><code>create_numerframe</code></a> so <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a> can be easily initialized. Think of it as a dynamic <code>pd.read_csv</code>, <code>pd.read_parquet</code>, etc. where you can also directly pass metadata.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;multi_target&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;tournament_type&quot;</span><span class="p">:</span> <span class="s2">&quot;classic&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">dataf</span> <span class="o">=</span> <span class="n">create_numerframe</span><span class="p">(</span><span class="s2">&quot;test_assets/mini_numerai_version_1_data.csv&quot;</span><span class="p">,</span>
                          <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span>
                          <span class="p">)</span>
<span class="k">assert</span> <span class="n">dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">multi_target</span>
<span class="n">dataf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>...</th>
      <th>feature_wisdom38</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>1.00</td>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 314 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="3d3d1f6e-365e-46cd-8f30-7a5a77b4c383"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#3d3d1f6e-365e-46cd-8f30-7a5a77b4c383');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "metadata = {\n    \"version\": 1,\n    \"multi_target\": False,\n    \"tournament_type\": \"classic\",\n}\n\ndataf = create_numerframe(\"test_assets/mini_numerai_version_1_data.csv\",\n                          metadata=metadata\n                          )\nassert dataf.meta.version == 1\nassert not dataf.meta.multi_target\ndataf.head(2)";
                var nbb_formatted_code = "metadata = {\n    \"version\": 1,\n    \"multi_target\": False,\n    \"tournament_type\": \"classic\",\n}\n\ndataf = create_numerframe(\n    \"test_assets/mini_numerai_version_1_data.csv\", metadata=metadata\n)\nassert dataf.meta.version == 1\nassert not dataf.meta.multi_target\ndataf.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Example-functionality">3. Example functionality<a class="anchor-link" href="#3.-Example-functionality"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">meta</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;era_col&#39;: &#39;era&#39;,
 &#39;era_col_verified&#39;: True,
 &#39;version&#39;: 1,
 &#39;additional_info&#39;: &#39;test_model&#39;,
 &#39;multi_target&#39;: False,
 &#39;tournament_type&#39;: &#39;classic&#39;}</pre>
</div>

</div>

<div class="output_area">




<div id="d8232fbd-404a-43ea-b7c4-d398967b134c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d8232fbd-404a-43ea-b7c4-d398967b134c');

            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "dataf.meta";
                var nbb_formatted_code = "dataf.meta";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_feature_data</code> will retrieve all columns where the column name starts with <code>feature</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">get_feature_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>feature_intelligence8</th>
      <th>feature_intelligence9</th>
      <th>feature_intelligence10</th>
      <th>...</th>
      <th>feature_wisdom37</th>
      <th>feature_wisdom38</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.75</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 310 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="ce31cf07-7286-4fd1-84b2-534e3c37786f"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#ce31cf07-7286-4fd1-84b2-534e3c37786f');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "dataf.get_feature_data.head(2)";
                var nbb_formatted_code = "dataf.get_feature_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_target_data</code> retrieves all columns if the column name starts with <code>"target"</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">get_target_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="bb84b9b4-0415-432c-96f0-6ac1ef7fece8"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#bb84b9b4-0415-432c-96f0-6ac1ef7fece8');

            setTimeout(function() {
                var nbb_cell_id = 16;
                var nbb_unformatted_code = "dataf.get_target_data.head(2)";
                var nbb_formatted_code = "dataf.get_target_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_single_target_data</code> only retrieves the column <code>"target"</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">get_single_target_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="c4b8e767-ca4a-4a5b-aebd-a9427e0af510"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c4b8e767-ca4a-4a5b-aebd-a9427e0af510');

            setTimeout(function() {
                var nbb_cell_id = 17;
                var nbb_unformatted_code = "dataf.get_single_target_data.head(2)";
                var nbb_formatted_code = "dataf.get_single_target_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_era_batch</code> will return a <code>tf.Tensor</code> or <code>np.ndarray</code> with feature data and target data for one or more eras. Convenient for creating neural network DataGenerators.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_era</span><span class="p">,</span> <span class="n">y_era</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">get_era_batch</span><span class="p">([</span><span class="s1">&#39;era1&#39;</span><span class="p">],</span> <span class="n">convert_to_tf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="n">X_era</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-14 15:27:09.402539: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(10, 310), dtype=float16, numpy=
array([[0.  , 0.5 , 0.25, ..., 1.  , 0.5 , 0.75],
       [0.  , 0.  , 0.  , ..., 0.  , 0.25, 1.  ],
       [0.25, 0.5 , 0.25, ..., 0.  , 0.25, 0.75],
       ...,
       [0.25, 1.  , 1.  , ..., 0.75, 0.5 , 0.25],
       [0.5 , 0.5 , 0.5 , ..., 0.  , 0.  , 0.  ],
       [0.5 , 1.  , 1.  , ..., 1.  , 1.  , 0.75]], dtype=float16)&gt;</pre>
</div>

</div>

<div class="output_area">




<div id="b7830dd6-6b83-4f16-8e69-6ea2d1023bbc"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b7830dd6-6b83-4f16-8e69-6ea2d1023bbc');

            setTimeout(function() {
                var nbb_cell_id = 18;
                var nbb_unformatted_code = "X_era, y_era = dataf.get_era_batch(['era1'], convert_to_tf=True, dtype=tf.float16)\nX_era";
                var nbb_formatted_code = "X_era, y_era = dataf.get_era_batch([\"era1\"], convert_to_tf=True, dtype=tf.float16)\nX_era";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For people training autoencoders + MLP you can get a target that contains 3 elements: features, targets and targets. Just define <code>aemlp_batch=True</code>.
More info on this setup: <a href="https://forum.numer.ai/t/autoencoder-and-multitask-mlp-on-new-dataset-from-kaggle-jane-street/4338">AutoEncoder and multitask MLP on new dataset forum post</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">y_era_aemlp</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">get_era_batch</span><span class="p">([</span><span class="s1">&#39;era1&#39;</span><span class="p">],</span> <span class="n">convert_to_tf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">aemlp_batch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="n">y_era_aemlp</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;tf.Tensor: shape=(10, 310), dtype=float16, numpy=
 array([[0.  , 0.5 , 0.25, ..., 1.  , 0.5 , 0.75],
        [0.  , 0.  , 0.  , ..., 0.  , 0.25, 1.  ],
        [0.25, 0.5 , 0.25, ..., 0.  , 0.25, 0.75],
        ...,
        [0.25, 1.  , 1.  , ..., 0.75, 0.5 , 0.25],
        [0.5 , 0.5 , 0.5 , ..., 0.  , 0.  , 0.  ],
        [0.5 , 1.  , 1.  , ..., 1.  , 1.  , 0.75]], dtype=float16)&gt;,
 &lt;tf.Tensor: shape=(10, 1), dtype=float16, numpy=
 array([[0.5 ],
        [0.25],
        [0.25],
        [0.25],
        [0.75],
        [0.5 ],
        [0.25],
        [0.25],
        [0.5 ],
        [0.75]], dtype=float16)&gt;,
 &lt;tf.Tensor: shape=(10, 1), dtype=float16, numpy=
 array([[0.5 ],
        [0.25],
        [0.25],
        [0.25],
        [0.75],
        [0.5 ],
        [0.25],
        [0.25],
        [0.5 ],
        [0.75]], dtype=float16)&gt;]</pre>
</div>

</div>

<div class="output_area">




<div id="cd356f1e-9d8d-41fc-b3ed-b42852bee74e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#cd356f1e-9d8d-41fc-b3ed-b42852bee74e');

            setTimeout(function() {
                var nbb_cell_id = 19;
                var nbb_unformatted_code = "_, y_era_aemlp = dataf.get_era_batch(['era1'], convert_to_tf=True, aemlp_batch=True, dtype=tf.float16)\ny_era_aemlp";
                var nbb_formatted_code = "_, y_era_aemlp = dataf.get_era_batch(\n    [\"era1\"], convert_to_tf=True, aemlp_batch=True, dtype=tf.float16\n)\ny_era_aemlp";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.aux_cols</code> denotes all columns that are not features, targets or prediction columns.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">aux_cols</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;id&#39;, &#39;era&#39;, &#39;data_type&#39;]</pre>
</div>

</div>

<div class="output_area">




<div id="8b77ca24-183b-4466-a0b1-8bce601b665f"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#8b77ca24-183b-4466-a0b1-8bce601b665f');

            setTimeout(function() {
                var nbb_cell_id = 20;
                var nbb_unformatted_code = "dataf.aux_cols";
                var nbb_formatted_code = "dataf.aux_cols";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">get_aux_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="05739363-56be-4bc7-83ab-b4914a18819e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#05739363-56be-4bc7-83ab-b4914a18819e');

            setTimeout(function() {
                var nbb_cell_id = 21;
                var nbb_unformatted_code = "dataf.get_aux_data.head(2)";
                var nbb_formatted_code = "dataf.get_aux_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Arbitrary <code>.json</code> metadata can be stored into the <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a>. All metadata can also be exported to a <code>.json</code> file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">export_json_metadata</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 Exporting metadata to config.json 📁
</pre>

</div>

</div>

<div class="output_area">




<div id="b21c6b67-4061-4ee5-bc4a-1227a9df67f9"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b21c6b67-4061-4ee5-bc4a-1227a9df67f9');

            setTimeout(function() {
                var nbb_cell_id = 22;
                var nbb_unformatted_code = "dataf.export_json_metadata(\"config.json\")";
                var nbb_formatted_code = "dataf.export_json_metadata(\"config.json\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">import_json_metadata</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 Importing metadata from config.json 📁
</pre>

</div>

</div>

<div class="output_area">




<div id="b6f2d358-d0cf-40ab-bb7e-ae16d0ccab88"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b6f2d358-d0cf-40ab-bb7e-ae16d0ccab88');

            setTimeout(function() {
                var nbb_cell_id = 23;
                var nbb_unformatted_code = "dataf.import_json_metadata(\"config.json\")";
                var nbb_formatted_code = "dataf.import_json_metadata(\"config.json\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">dataf</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">multi_target</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="80887916-e72b-489f-90b7-a4c57634e47a"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#80887916-e72b-489f-90b7-a4c57634e47a');

            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "assert dataf.meta.version == 1\nassert not dataf.meta.multi_target";
                var nbb_formatted_code = "assert dataf.meta.version == 1\nassert not dataf.meta.multi_target";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because <a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a> inherits from <code>pd.DataFrame</code> you still have all functionality of a normal DataFrame at your disposal, like copying.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf2</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">dataf2</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">dataf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="f63f3355-5b71-41d8-bf77-773bec8d3bcc"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#f63f3355-5b71-41d8-bf77-773bec8d3bcc');

            setTimeout(function() {
                var nbb_cell_id = 25;
                var nbb_unformatted_code = "dataf2 = dataf.copy()\nassert dataf2.equals(dataf)";
                var nbb_formatted_code = "dataf2 = dataf.copy()\nassert dataf2.equals(dataf)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerblox/numerframe.html#NumerFrame"><code>NumerFrame</code></a> dynamically tracks which feature, target, aux and prediction columns there are when initialized. For example, here we add a new prediction column. Upon initialization the column will be contained in <code>prediction_cols</code>. Prediction columns are all column names that start with <code>prediction</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;prediction_test_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataf</span><span class="p">))</span>
<span class="n">new_dataset</span> <span class="o">=</span> <span class="n">NumerFrame</span><span class="p">(</span><span class="n">dataf</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">new_dataset</span><span class="o">.</span><span class="n">prediction_cols</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;prediction_test_1&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">new_dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="fb7c4a76-8c3f-493a-bb1a-32740f2756e1"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#fb7c4a76-8c3f-493a-bb1a-32740f2756e1');

            setTimeout(function() {
                var nbb_cell_id = 26;
                var nbb_unformatted_code = "dataf.loc[:, \"prediction_test_1\"] = np.random.uniform(size=len(dataf))\nnew_dataset = NumerFrame(dataf)\nassert new_dataset.prediction_cols == [\"prediction_test_1\"]\nassert new_dataset.meta.version == 1";
                var nbb_formatted_code = "dataf.loc[:, \"prediction_test_1\"] = np.random.uniform(size=len(dataf))\nnew_dataset = NumerFrame(dataf)\nassert new_dataset.prediction_cols == [\"prediction_test_1\"]\nassert new_dataset.meta.version == 1";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Arbitrary columns van be retrieved with <code>.get_column_selection</code>. The input argument can be either a string or a list with column names.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selection1</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">get_column_selection</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">selection1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="333e8c37-de3d-4db2-b5f6-0ca1599d7fef"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#333e8c37-de3d-4db2-b5f6-0ca1599d7fef');

            setTimeout(function() {
                var nbb_cell_id = 27;
                var nbb_unformatted_code = "selection1 = dataf.get_column_selection(\"id\")\nselection1.head(2)";
                var nbb_formatted_code = "selection1 = dataf.get_column_selection(\"id\")\nselection1.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selection2</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">get_column_selection</span><span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;prediction_test_1&quot;</span><span class="p">])</span>
<span class="n">selection2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>prediction_test_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>0.192099</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>0.337739</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="2656a4f3-3490-46e5-884e-797699c9aac3"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#2656a4f3-3490-46e5-884e-797699c9aac3');

            setTimeout(function() {
                var nbb_cell_id = 28;
                var nbb_unformatted_code = "selection2 = dataf.get_column_selection([\"id\", \"prediction_test_1\"])\nselection2.head(2)";
                var nbb_formatted_code = "selection2 = dataf.get_column_selection([\"id\", \"prediction_test_1\"])\nselection2.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For convenience we can get a feature, target pair with one method. <code>X</code> will have all feature data and <code>y</code> all target data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">features</span><span class="p">,</span> <span class="n">single_target</span> <span class="o">=</span> <span class="n">dataf</span><span class="o">.</span><span class="n">get_feature_target_pair</span><span class="p">(</span><span class="n">multi_target</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">features</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>feature_intelligence8</th>
      <th>feature_intelligence9</th>
      <th>feature_intelligence10</th>
      <th>...</th>
      <th>feature_wisdom37</th>
      <th>feature_wisdom38</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.75</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 310 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="7d1245b4-da2f-4d66-a2d8-42ce2c99bb8d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7d1245b4-da2f-4d66-a2d8-42ce2c99bb8d');

            setTimeout(function() {
                var nbb_cell_id = 30;
                var nbb_unformatted_code = "features, single_target = dataf.get_feature_target_pair(multi_target=False)\nfeatures.head(2)";
                var nbb_formatted_code = "features, single_target = dataf.get_feature_target_pair(multi_target=False)\nfeatures.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">single_target</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="e26df622-2b1c-4b1f-a730-82dd0460a614"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e26df622-2b1c-4b1f-a730-82dd0460a614');

            setTimeout(function() {
                var nbb_cell_id = 31;
                var nbb_unformatted_code = "single_target.head(2)";
                var nbb_formatted_code = "single_target.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can directly generate a <a href="https://pandas-profiling.github.io/pandas-profiling/docs/master/index.html">pandas-profiling</a> report with the same arguments that are available for <code>ProfileReport</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">report</span> <span class="o">=</span> <span class="n">memory_dataf</span><span class="o">.</span><span class="n">profile_report</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mini Numerai V1 report&quot;</span><span class="p">,</span> <span class="n">explorative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">ProfileReport</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="1afc4202-1cdd-44cd-943d-57fa31c64951"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#1afc4202-1cdd-44cd-943d-57fa31c64951');

            setTimeout(function() {
                var nbb_cell_id = 32;
                var nbb_unformatted_code = "# slow\nreport = memory_dataf.profile_report(title=\"Mini Numerai V1 report\", explorative=True)\nassert isinstance(report, ProfileReport)";
                var nbb_formatted_code = "# slow\nreport = memory_dataf.profile_report(title=\"Mini Numerai V1 report\", explorative=True)\nassert isinstance(report, ProfileReport)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>
 

