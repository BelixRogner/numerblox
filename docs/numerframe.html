---

title: NumerFrame


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/02_numerframe.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_numerframe.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">load_ext</span> nb_black
<span class="o">%</span><span class="k">load_ext</span> lab_black
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[autoreload of jupyter_client.blocking.client failed: Traceback (most recent call last):
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 245, in check
    superreload(m, reload, self.old_objects)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 410, in superreload
    update_generic(old_obj, new_obj)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 302, in update_class
    if update_generic(old_obj, new_obj): continue
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 266, in update_function
    setattr(old, name, getattr(new, name))
ValueError: wrapped() requires a code object with 1 free vars, not 0
]
[autoreload of jupyter_client.manager failed: Traceback (most recent call last):
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 245, in check
    superreload(m, reload, self.old_objects)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 410, in superreload
    update_generic(old_obj, new_obj)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 302, in update_class
    if update_generic(old_obj, new_obj): continue
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 266, in update_function
    setattr(old, name, getattr(new, name))
ValueError: wrapped() requires a code object with 1 free vars, not 0
]
[autoreload of jupyter_client.multikernelmanager failed: Traceback (most recent call last):
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 245, in check
    superreload(m, reload, self.old_objects)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 410, in superreload
    update_generic(old_obj, new_obj)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 302, in update_class
    if update_generic(old_obj, new_obj): continue
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 266, in update_function
    setattr(old, name, getattr(new, name))
ValueError: wrapped() requires a code object with 1 free vars, not 0
]
[autoreload of nbconvert.exporters.templateexporter failed: Traceback (most recent call last):
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 245, in check
    superreload(m, reload, self.old_objects)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 410, in superreload
    update_generic(old_obj, new_obj)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 302, in update_class
    if update_generic(old_obj, new_obj): continue
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 266, in update_function
    setattr(old, name, getattr(new, name))
ValueError: _init_preprocessors() requires a code object with 1 free vars, not 0
]
[autoreload of nbconvert.preprocessors.execute failed: Traceback (most recent call last):
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 245, in check
    superreload(m, reload, self.old_objects)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 410, in superreload
    update_generic(old_obj, new_obj)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 302, in update_class
    if update_generic(old_obj, new_obj): continue
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 266, in update_function
    setattr(old, name, getattr(new, name))
ValueError: __init__() requires a code object with 0 free vars, not 1
]
[autoreload of nbconvert.preprocessors.clearmetadata failed: Traceback (most recent call last):
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 245, in check
    superreload(m, reload, self.old_objects)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 410, in superreload
    update_generic(old_obj, new_obj)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 302, in update_class
    if update_generic(old_obj, new_obj): continue
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 347, in update_generic
    update(a, b)
  File &#34;/opt/anaconda3/envs/numerai-blocks37/lib/python3.7/site-packages/IPython/extensions/autoreload.py&#34;, line 266, in update_function
    setattr(old, name, getattr(new, name))
ValueError: preprocess() requires a code object with 1 free vars, not 0
]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
The nb_black extension is already loaded. To reload it, use:
  %reload_ext nb_black
The lab_black extension is already loaded. To reload it, use:
  %reload_ext lab_black
</pre>
</div>
</div>

<div class="output_area">




<div id="08fd8031-80aa-4e1e-8f6c-4b47760fc888"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#08fd8031-80aa-4e1e-8f6c-4b47760fc888');

            setTimeout(function() {
                var nbb_cell_id = 34;
                var nbb_unformatted_code = "%load_ext autoreload\n%autoreload 2\n%load_ext nb_black\n%load_ext lab_black";
                var nbb_formatted_code = "%load_ext autoreload\n%autoreload 2\n%load_ext nb_black\n%load_ext lab_black";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-NumerFrame">The NumerFrame<a class="anchor-link" href="#The-NumerFrame"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> is a data structure that extends <code>pd.DataFrame</code> with functionality specific for Numerai users. The main benefits include:</p>
<ol>
<li>Add, export, import metadata. Furthermore, dynamically update or manipulate metadata within your Numerai data pipeline.</li>
<li>Automatically track features, targets, prediction and other columns + easily retrieve these sections.</li>
<li>Convenient functionality based on <code>era</code> or <code>friday_date</code>.</li>
<li>Integrations with other <code>numerai-blocks</code> (Preprocessors, ModelPipelines, Postprocessors, Evaluation and Submission) to better support and increase reliability of Numerai inference pipelines.</li>
</ol>
<p>Besides, all functionality of Pandas DataFrames is still available in the <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a>. You therefore don't have create new pipelines to process your data and make predictions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We adopt the convention:</p>
<ol>
<li>All feature column names should start with "feature".</li>
<li>All target column names should start with "target".</li>
<li>All prediction column names should start with "prediction".</li>
<li>Data should contain an <code>era</code> or <code>friday_date</code> column, as is almost always the case with Numerai datasets.</li>
</ol>
<p>Every column for which this does not hold will be classified as an "aux column".</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AttrDict" class="doc_header"><code>class</code> <code>AttrDict</code><a href="https://github.com/crowdcent/numerai_blocks/tree/main/numerai_blocks/numerframe.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AttrDict</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>dict</code></p>
</blockquote>
<p>Access dictionary elements as attributes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NumerFrame" class="doc_header"><code>class</code> <code>NumerFrame</code><a href="https://github.com/crowdcent/numerai_blocks/tree/main/numerai_blocks/numerframe.py#L23" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NumerFrame</code>(<strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <code>DataFrame</code></p>
</blockquote>
<p>Data structure which extends Pandas DataFrames and
allows for additional Numerai specific functionality.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="eb729d99-2a7e-488e-a5d1-d6c1fc11d37f"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#eb729d99-2a7e-488e-a5d1-d6c1fc11d37f');

            setTimeout(function() {
                var nbb_cell_id = 38;
                var nbb_unformatted_code = "# export\nclass AttrDict(dict):\n    \"\"\" Access dictionary elements as attributes. \"\"\"\n    def __init__(self, *args, **kwargs):\n        super(AttrDict, self).__init__(*args, **kwargs)\n        self.__dict__ = self\n\nclass NumerFrame(pd.DataFrame):\n    \"\"\"\n    Data structure which extends Pandas DataFrames and\n    allows for additional Numerai specific functionality.\n    \"\"\"\n    _metadata = [\"meta\", \"feature_cols\", \"target_cols\",\n                 \"prediction_cols\", \"not_aux_cols\", \"aux_cols\"]\n    meta = AttrDict()\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.__init_meta_attrs()\n        if not \"era_col_verified\" in self.meta:\n            self.__set_era_col()\n\n    @property\n    def _constructor(self):\n        return NumerFrame\n\n    def __init_meta_attrs(self):\n        \"\"\" Dynamically track column groups. \"\"\"\n        self.feature_cols = [col for col in self.columns if col.startswith(\"feature\")]\n        self.target_cols = [col for col in self.columns if col.startswith(\"target\")]\n        self.prediction_cols = [\n            col for col in self.columns if col.startswith(\"prediction\")\n        ]\n        self.not_aux_cols = self.feature_cols + self.target_cols + self.prediction_cols\n        self.aux_cols = [\n            col for col in self.columns if col not in self.not_aux_cols\n        ]\n\n    def __set_era_col(self):\n        \"\"\" Each NumerFrame should have an era column to benefit from all functionality. \"\"\"\n        if \"era\" in self.columns:\n            self.meta.era_col = \"era\"\n        elif \"friday_date\" in self.columns:\n            self.meta.era_col = \"friday_date\"\n        else:\n            raise AttributeError(\"NumerFrame must contain either an 'era' or 'friday_date' column.\")\n        self.meta.era_col_verified = True\n\n    def add_metadata(self, *args, **kwargs):\n        \"\"\" Parse arbitrary metadata (i.e. Python objects) to the meta attribute. \"\"\"\n        self.meta.update(*args, **kwargs)\n\n    def export_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Export all attributes in NumerFrame that can be serialized to json file.\"\"\"\n        rich_print(f\":file_folder: Exporting metadata to {file} :file_folder:\")\n        json_txt = json.dumps(\n            self.meta.__dict__, default=lambda o: \"<not serializable>\", **kwargs\n        )\n        if verbose:\n            rich_print(json_txt)\n        Path(file).write_text(json_txt)\n\n    def import_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Load arbitrary data into NumerFrame object from json file.\"\"\"\n        rich_print(f\":file_folder: Importing metadata from {file} :file_folder:\")\n        with open(file) as json_file:\n            json_data = json.load(json_file, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        self.meta.__dict__.update(json_data)\n\n    def get_column_selection(self, cols: Union[str, list]):\n        \"\"\" Return NumerFrame from selection of columns. \"\"\"\n        return self.loc[:, cols if isinstance(cols, list) else [cols]]\n\n    @property\n    def get_feature_data(self):\n        \"\"\" All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.feature_cols)\n\n    @property\n    def get_target_data(self):\n        \"\"\" All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.target_cols)\n\n    @property\n    def get_single_target_data(self):\n        \"\"\" Column with name 'target' (Main Numerai target column). \"\"\"\n        return self.get_column_selection(cols=['target'])\n\n    @property\n    def get_prediction_data(self):\n        \"\"\" All columns for which name starts with 'prediction'.\"\"\"\n        return self.get_column_selection(cols=self.prediction_cols)\n\n    @property\n    def get_aux_data(self):\n        \"\"\" All columns that are not features, targets or predictions. \"\"\"\n        return self.get_column_selection(cols=self.aux_cols)\n\n    def get_feature_target_pair(self, multi_target=False) -> Tuple[pd.DataFrame, Any]:\n        \"\"\"\n        Get split of feature and target columns.\n        :param multi_target: Returns only 'target' column by default.\n        Returns all target columns when set to True.\n        \"\"\"\n        X = self.get_feature_data\n        y = self.get_target_data if multi_target else self.get_single_target_data\n        return X, y\n\n    def get_era_batch(self, eras: List[Any], convert_to_tf = False, aemlp_batch = False, *args, **kwargs) -> tuple:\n        \"\"\"\n        Get feature target pair batch of 1 or multiple eras.\n        :param eras: List of era names. They need to be present in era_col.\n        :param convert_to_tf: Convert to tf.Tensor.\n        :param aemlp_batch: Specific target batch for autoencoder training.\n        y will contain three components: features, targets and targets.\n        *args, **kwargs are passed to initialization of Tensor.\n        \"\"\"\n        valid_eras = []\n        for era in eras:\n            assert era in self[self.meta.era_col].unique(), f\"Era '{era}' not found in era column ({self.meta.era_col})\"\n            valid_eras.append(era)\n        X = self.loc[self[self.meta.era_col].isin(valid_eras)][self.feature_cols].values\n        y = self.loc[self[self.meta.era_col].isin(valid_eras)][self.target_cols].values\n        if aemlp_batch:\n            y = [X.copy(), y.copy(), y.copy()]\n\n        if convert_to_tf:\n            X = tf.convert_to_tensor(X, *args, **kwargs)\n            if aemlp_batch:\n                y = [tf.convert_to_tensor(i, *args, **kwargs) for i in y]\n            else:\n                y = tf.convert_to_tensor(y, *args, **kwargs)\n        return X, y\n\n    def profile_report(self, *args, **kwargs) -> ProfileReport:\n        \"\"\"\n        DataFrame profiling. Might take a while to generate for large datasets.\n        For more info: https://pandas-profiling.github.io/pandas-profiling/docs/master/index.html\n        *args, **kwargs will be passed to ProfileReport initialization.\n        \"\"\"\n        return ProfileReport(self, *args, **kwargs)";
                var nbb_formatted_code = "# export\nclass AttrDict(dict):\n    \"\"\"Access dictionary elements as attributes.\"\"\"\n\n    def __init__(self, *args, **kwargs):\n        super(AttrDict, self).__init__(*args, **kwargs)\n        self.__dict__ = self\n\n\nclass NumerFrame(pd.DataFrame):\n    \"\"\"\n    Data structure which extends Pandas DataFrames and\n    allows for additional Numerai specific functionality.\n    \"\"\"\n\n    _metadata = [\n        \"meta\",\n        \"feature_cols\",\n        \"target_cols\",\n        \"prediction_cols\",\n        \"not_aux_cols\",\n        \"aux_cols\",\n    ]\n    meta = AttrDict()\n\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self.__init_meta_attrs()\n        if not \"era_col_verified\" in self.meta:\n            self.__set_era_col()\n\n    @property\n    def _constructor(self):\n        return NumerFrame\n\n    def __init_meta_attrs(self):\n        \"\"\"Dynamically track column groups.\"\"\"\n        self.feature_cols = [col for col in self.columns if col.startswith(\"feature\")]\n        self.target_cols = [col for col in self.columns if col.startswith(\"target\")]\n        self.prediction_cols = [\n            col for col in self.columns if col.startswith(\"prediction\")\n        ]\n        self.not_aux_cols = self.feature_cols + self.target_cols + self.prediction_cols\n        self.aux_cols = [col for col in self.columns if col not in self.not_aux_cols]\n\n    def __set_era_col(self):\n        \"\"\"Each NumerFrame should have an era column to benefit from all functionality.\"\"\"\n        if \"era\" in self.columns:\n            self.meta.era_col = \"era\"\n        elif \"friday_date\" in self.columns:\n            self.meta.era_col = \"friday_date\"\n        else:\n            raise AttributeError(\n                \"NumerFrame must contain either an 'era' or 'friday_date' column.\"\n            )\n        self.meta.era_col_verified = True\n\n    def add_metadata(self, *args, **kwargs):\n        \"\"\"Parse arbitrary metadata (i.e. Python objects) to the meta attribute.\"\"\"\n        self.meta.update(*args, **kwargs)\n\n    def export_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Export all attributes in NumerFrame that can be serialized to json file.\"\"\"\n        rich_print(f\":file_folder: Exporting metadata to {file} :file_folder:\")\n        json_txt = json.dumps(\n            self.meta.__dict__, default=lambda o: \"<not serializable>\", **kwargs\n        )\n        if verbose:\n            rich_print(json_txt)\n        Path(file).write_text(json_txt)\n\n    def import_json_metadata(self, file=\"config.json\", verbose=False, **kwargs):\n        \"\"\"Load arbitrary data into NumerFrame object from json file.\"\"\"\n        rich_print(f\":file_folder: Importing metadata from {file} :file_folder:\")\n        with open(file) as json_file:\n            json_data = json.load(json_file, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        self.meta.__dict__.update(json_data)\n\n    def get_column_selection(self, cols: Union[str, list]):\n        \"\"\"Return NumerFrame from selection of columns.\"\"\"\n        return self.loc[:, cols if isinstance(cols, list) else [cols]]\n\n    @property\n    def get_feature_data(self):\n        \"\"\"All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.feature_cols)\n\n    @property\n    def get_target_data(self):\n        \"\"\"All columns for which name starts with 'target'.\"\"\"\n        return self.get_column_selection(cols=self.target_cols)\n\n    @property\n    def get_single_target_data(self):\n        \"\"\"Column with name 'target' (Main Numerai target column).\"\"\"\n        return self.get_column_selection(cols=[\"target\"])\n\n    @property\n    def get_prediction_data(self):\n        \"\"\"All columns for which name starts with 'prediction'.\"\"\"\n        return self.get_column_selection(cols=self.prediction_cols)\n\n    @property\n    def get_aux_data(self):\n        \"\"\"All columns that are not features, targets or predictions.\"\"\"\n        return self.get_column_selection(cols=self.aux_cols)\n\n    def get_feature_target_pair(self, multi_target=False) -> Tuple[pd.DataFrame, Any]:\n        \"\"\"\n        Get split of feature and target columns.\n        :param multi_target: Returns only 'target' column by default.\n        Returns all target columns when set to True.\n        \"\"\"\n        X = self.get_feature_data\n        y = self.get_target_data if multi_target else self.get_single_target_data\n        return X, y\n\n    def get_era_batch(\n        self, eras: List[Any], convert_to_tf=False, aemlp_batch=False, *args, **kwargs\n    ) -> tuple:\n        \"\"\"\n        Get feature target pair batch of 1 or multiple eras.\n        :param eras: List of era names. They need to be present in era_col.\n        :param convert_to_tf: Convert to tf.Tensor.\n        :param aemlp_batch: Specific target batch for autoencoder training.\n        y will contain three components: features, targets and targets.\n        *args, **kwargs are passed to initialization of Tensor.\n        \"\"\"\n        valid_eras = []\n        for era in eras:\n            assert (\n                era in self[self.meta.era_col].unique()\n            ), f\"Era '{era}' not found in era column ({self.meta.era_col})\"\n            valid_eras.append(era)\n        X = self.loc[self[self.meta.era_col].isin(valid_eras)][self.feature_cols].values\n        y = self.loc[self[self.meta.era_col].isin(valid_eras)][self.target_cols].values\n        if aemlp_batch:\n            y = [X.copy(), y.copy(), y.copy()]\n\n        if convert_to_tf:\n            X = tf.convert_to_tensor(X, *args, **kwargs)\n            if aemlp_batch:\n                y = [tf.convert_to_tensor(i, *args, **kwargs) for i in y]\n            else:\n                y = tf.convert_to_tensor(y, *args, **kwargs)\n        return X, y\n\n    def profile_report(self, *args, **kwargs) -> ProfileReport:\n        \"\"\"\n        DataFrame profiling. Might take a while to generate for large datasets.\n        For more info: https://pandas-profiling.github.io/pandas-profiling/docs/master/index.html\n        *args, **kwargs will be passed to ProfileReport initialization.\n        \"\"\"\n        return ProfileReport(self, *args, **kwargs)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_numerframe" class="doc_header"><code>create_numerframe</code><a href="https://github.com/crowdcent/numerai_blocks/tree/main/numerai_blocks/numerframe.py#L161" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_numerframe</code>(<strong><code>file_path</code></strong>:<code>str</code>, <strong><code>metadata</code></strong>:<code>dict</code>=<em><code>None</code></em>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Convenience function to initialize NumerFrame.
Support most used file formats for Pandas DataFrames (CSV, Parquet, Pickle, JSON and Excel).
For more details check <a href="https://pandas.pydata.org/docs/reference/io.html">https://pandas.pydata.org/docs/reference/io.html</a></p>
<p>:param file_path: Relative or absolute path to data file.
:param metadata: Metadata to be stored in NumerFrame.meta.
*args, **kwargs will be passed to Pandas loading function.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="5c6ec59d-9906-44ae-9407-d9cd9ba53fd9"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#5c6ec59d-9906-44ae-9407-d9cd9ba53fd9');

            setTimeout(function() {
                var nbb_cell_id = 39;
                var nbb_unformatted_code = "#export\ndef create_numerframe(file_path: str, metadata: dict = None, *args, **kwargs) -> NumerFrame:\n    \"\"\"\n    Convenience function to initialize NumerFrame.\n    Support most used file formats for Pandas DataFrames (CSV, Parquet, Pickle, JSON and Excel).\n    For more details check https://pandas.pydata.org/docs/reference/io.html\n\n    :param file_path: Relative or absolute path to data file.\n    :param metadata: Metadata to be stored in NumerFrame.meta.\n    *args, **kwargs will be passed to Pandas loading function.\n    \"\"\"\n    assert Path(file_path).is_file(), f\"{file_path} does not point to file.\"\n    # Suffix without dot\n    suffix = Path(file_path).suffix\n    if suffix in [\".csv\"]:\n        dataf = pd.read_csv(file_path, *args, **kwargs)\n    elif suffix in [\".parquet\"]:\n        dataf = pd.read_parquet(file_path, *args, **kwargs)\n    elif suffix in [\".pkl\", \".pickle\"]:\n        dataf = pd.read_pickle(file_path, *args, **kwargs)\n    elif suffix in [\".json\"]:\n        dataf = pd.read_json(file_path, *args, **kwargs)\n    elif suffix in [\".xls\", \".xlsx\", \".xlsm\", \"xlsb\", \".odf\", \".ods\", \".odt\"]:\n        dataf = pd.read_excel(file_path, *args, **kwargs)\n    else:\n        raise NotImplementedError\n    num_frame = NumerFrame(dataf)\n    if metadata:\n        num_frame.add_metadata(metadata)\n    return num_frame";
                var nbb_formatted_code = "# export\ndef create_numerframe(\n    file_path: str, metadata: dict = None, *args, **kwargs\n) -> NumerFrame:\n    \"\"\"\n    Convenience function to initialize NumerFrame.\n    Support most used file formats for Pandas DataFrames (CSV, Parquet, Pickle, JSON and Excel).\n    For more details check https://pandas.pydata.org/docs/reference/io.html\n\n    :param file_path: Relative or absolute path to data file.\n    :param metadata: Metadata to be stored in NumerFrame.meta.\n    *args, **kwargs will be passed to Pandas loading function.\n    \"\"\"\n    assert Path(file_path).is_file(), f\"{file_path} does not point to file.\"\n    # Suffix without dot\n    suffix = Path(file_path).suffix\n    if suffix in [\".csv\"]:\n        dataf = pd.read_csv(file_path, *args, **kwargs)\n    elif suffix in [\".parquet\"]:\n        dataf = pd.read_parquet(file_path, *args, **kwargs)\n    elif suffix in [\".pkl\", \".pickle\"]:\n        dataf = pd.read_pickle(file_path, *args, **kwargs)\n    elif suffix in [\".json\"]:\n        dataf = pd.read_json(file_path, *args, **kwargs)\n    elif suffix in [\".xls\", \".xlsx\", \".xlsm\", \"xlsb\", \".odf\", \".ods\", \".odt\"]:\n        dataf = pd.read_excel(file_path, *args, **kwargs)\n    else:\n        raise NotImplementedError\n    num_frame = NumerFrame(dataf)\n    if metadata:\n        num_frame.add_metadata(metadata)\n    return num_frame";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NumerFrame-Tests-and-Usage">NumerFrame Tests and Usage<a class="anchor-link" href="#NumerFrame-Tests-and-Usage"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> object can be initialized from memory just like you would with a Pandas DataFrame.
You then have the option to add metadata with <code>.add_metadata</code>. All metadata will be stored in the <code>meta</code> attribute.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Initialize-from-memory">Initialize from memory<a class="anchor-link" href="#Initialize-from-memory"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_features</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;feature_</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="s2">&quot;ABCDEFGHIK&quot;</span><span class="p">]</span>
<span class="n">id_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="n">test_features</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_col</span>
<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="s2">&quot;target_1&quot;</span><span class="p">,</span> <span class="s2">&quot;target_2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;era&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="472e6bdc-9b63-4e40-88b1-e56276d0dd1b"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#472e6bdc-9b63-4e40-88b1-e56276d0dd1b');

            setTimeout(function() {
                var nbb_cell_id = 40;
                var nbb_unformatted_code = "# Random DataFrame\ntest_features = [f\"feature_{l}\" for l in \"ABCDEFGHIK\"]\nid_col = [uuid.uuid4().hex for _ in range(100)]\n\ndf = pd.DataFrame(np.random.uniform(size=(100, 10)), columns=test_features)\ndf[\"id\"] = id_col\ndf[[\"target\", \"target_1\", \"target_2\"]] = np.random.normal(size=(100, 3))\ndf[\"era\"] = range(100)";
                var nbb_formatted_code = "# Random DataFrame\ntest_features = [f\"feature_{l}\" for l in \"ABCDEFGHIK\"]\nid_col = [uuid.uuid4().hex for _ in range(100)]\n\ndf = pd.DataFrame(np.random.uniform(size=(100, 10)), columns=test_features)\ndf[\"id\"] = id_col\ndf[[\"target\", \"target_1\", \"target_2\"]] = np.random.normal(size=(100, 3))\ndf[\"era\"] = range(100)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s2">&quot;additional_info&quot;</span><span class="p">:</span> <span class="s2">&quot;test_model&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multi_target&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;tournament_type&quot;</span><span class="p">:</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">memory_dataset</span> <span class="o">=</span> <span class="n">NumerFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">memory_dataset</span><span class="o">.</span><span class="n">add_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">42</span>
<span class="k">assert</span> <span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">tournament_type</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="e1d07bbd-2512-47cb-8875-65081ce8a6bf"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e1d07bbd-2512-47cb-8875-65081ce8a6bf');

            setTimeout(function() {
                var nbb_cell_id = 41;
                var nbb_unformatted_code = "metadata = {\n    \"version\": 42,\n    \"additional_info\": \"test_model\",\n    \"multi_target\": False,\n    \"tournament_type\": \"random\",\n}\nmemory_dataset = NumerFrame(df)\nmemory_dataset.add_metadata(metadata)\nassert memory_dataset.meta.version == 42\nassert memory_dataset.meta.tournament_type == \"random\"";
                var nbb_formatted_code = "metadata = {\n    \"version\": 42,\n    \"additional_info\": \"test_model\",\n    \"multi_target\": False,\n    \"tournament_type\": \"random\",\n}\nmemory_dataset = NumerFrame(df)\nmemory_dataset.add_metadata(metadata)\nassert memory_dataset.meta.version == 42\nassert memory_dataset.meta.tournament_type == \"random\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Metadata stored in `.meta' and can be accessed as a dictionary or as attributes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;era_col&#39;: &#39;era&#39;,
 &#39;era_col_verified&#39;: True,
 &#39;version&#39;: 42,
 &#39;additional_info&#39;: &#39;test_model&#39;,
 &#39;multi_target&#39;: False,
 &#39;tournament_type&#39;: &#39;random&#39;}</pre>
</div>

</div>

<div class="output_area">




<div id="2bd48a6e-c41e-4178-a421-d5f24deb42ee"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#2bd48a6e-c41e-4178-a421-d5f24deb42ee');

            setTimeout(function() {
                var nbb_cell_id = 42;
                var nbb_unformatted_code = "memory_dataset.meta";
                var nbb_formatted_code = "memory_dataset.meta";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>42</pre>
</div>

</div>

<div class="output_area">




<div id="673b0652-83dc-4b5f-adea-33e3ce03d3bc"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#673b0652-83dc-4b5f-adea-33e3ce03d3bc');

            setTimeout(function() {
                var nbb_cell_id = 43;
                var nbb_unformatted_code = "memory_dataset.meta.version";
                var nbb_formatted_code = "memory_dataset.meta.version";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>42</pre>
</div>

</div>

<div class="output_area">




<div id="adb28344-2080-4f5b-9a61-4b877e7c48b8"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#adb28344-2080-4f5b-9a61-4b877e7c48b8');

            setTimeout(function() {
                var nbb_cell_id = 44;
                var nbb_unformatted_code = "memory_dataset.meta['version']";
                var nbb_formatted_code = "memory_dataset.meta[\"version\"]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="n">memory_dataset</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="a1e75ae9-163d-4276-8c6f-da938555ebe5"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#a1e75ae9-163d-4276-8c6f-da938555ebe5');

            setTimeout(function() {
                var nbb_cell_id = 45;
                var nbb_unformatted_code = "assert memory_dataset.meta.version == memory_dataset.meta['version']";
                var nbb_formatted_code = "assert memory_dataset.meta.version == memory_dataset.meta[\"version\"]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From a <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> you can directly generate a <code>pandas-profiling</code> report with the same arguments that are available for <code>ProfileReport</code>.
Docs: <a href="https://pandas-profiling.github.io/pandas-profiling/docs/master/index.html">pandas-profiling</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">report</span> <span class="o">=</span> <span class="n">memory_dataset</span><span class="o">.</span><span class="n">profile_report</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mini Numerai V1 report&quot;</span><span class="p">,</span> <span class="n">explorative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">ProfileReport</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="c5c71b36-6fb3-476d-a9a8-2fd807570f46"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#c5c71b36-6fb3-476d-a9a8-2fd807570f46');

            setTimeout(function() {
                var nbb_cell_id = 46;
                var nbb_unformatted_code = "# slow\nreport = memory_dataset.profile_report(title=\"Mini Numerai V1 report\", explorative=True)\nassert isinstance(report, ProfileReport)";
                var nbb_formatted_code = "# slow\nreport = memory_dataset.profile_report(title=\"Mini Numerai V1 report\", explorative=True)\nassert isinstance(report, ProfileReport)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Initialize-from-file">Initialize from file<a class="anchor-link" href="#Initialize-from-file"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can also use the convenience function <a href="/numerai_blocks/numerframe.html#create_numerframe"><code>create_numerframe</code></a> so <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> can be easily initialized. <code>create_dataset</code> supports most extensions that Pandas offers, like <code>.csv</code>, <code>.parquet</code>, <code>.pkl</code>, <code>.pickle</code>, etc. Think of it as a more dynamic <code>pd.read_csv</code>, <code>pd.read_parquet</code>, etc. where you can also directly pass metadata.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;multi_target&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;tournament_type&quot;</span><span class="p">:</span> <span class="s2">&quot;classic&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">create_numerframe</span><span class="p">(</span><span class="s2">&quot;test_assets/mini_numerai_version_1_data.csv&quot;</span><span class="p">,</span>
                            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span>
                            <span class="p">)</span>
<span class="k">assert</span> <span class="n">dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">multi_target</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>...</th>
      <th>feature_wisdom38</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.75</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>1.00</td>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 314 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="4b6c0b6c-bada-4375-8631-1a9ffc396e04"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#4b6c0b6c-bada-4375-8631-1a9ffc396e04');

            setTimeout(function() {
                var nbb_cell_id = 47;
                var nbb_unformatted_code = "metadata = {\n    \"version\": 1,\n    \"multi_target\": False,\n    \"tournament_type\": \"classic\",\n}\n\ndataset = create_numerframe(\"test_assets/mini_numerai_version_1_data.csv\",\n                            metadata=metadata\n                            )\nassert dataset.meta.version == 1\nassert not dataset.meta.multi_target\ndataset.head(2)";
                var nbb_formatted_code = "metadata = {\n    \"version\": 1,\n    \"multi_target\": False,\n    \"tournament_type\": \"classic\",\n}\n\ndataset = create_numerframe(\n    \"test_assets/mini_numerai_version_1_data.csv\", metadata=metadata\n)\nassert dataset.meta.version == 1\nassert not dataset.meta.multi_target\ndataset.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">meta</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;era_col&#39;: &#39;era&#39;,
 &#39;era_col_verified&#39;: True,
 &#39;version&#39;: 1,
 &#39;additional_info&#39;: &#39;test_model&#39;,
 &#39;multi_target&#39;: False,
 &#39;tournament_type&#39;: &#39;classic&#39;}</pre>
</div>

</div>

<div class="output_area">




<div id="d8d7e7ed-7189-41d3-b1b7-adf148f3473f"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d8d7e7ed-7189-41d3-b1b7-adf148f3473f');

            setTimeout(function() {
                var nbb_cell_id = 48;
                var nbb_unformatted_code = "dataset.meta";
                var nbb_formatted_code = "dataset.meta";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_feature_data</code> will retrieve all columns where the column name starts with <code>feature</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">get_feature_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>feature_intelligence8</th>
      <th>feature_intelligence9</th>
      <th>feature_intelligence10</th>
      <th>...</th>
      <th>feature_wisdom37</th>
      <th>feature_wisdom38</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.75</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 310 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="6cc72e13-2604-4dfb-b9ec-651a9826ce6f"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#6cc72e13-2604-4dfb-b9ec-651a9826ce6f');

            setTimeout(function() {
                var nbb_cell_id = 49;
                var nbb_unformatted_code = "dataset.get_feature_data.head(2)";
                var nbb_formatted_code = "dataset.get_feature_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_target_data</code> retrieves all columns where the column name starts with "target". <code>get_single_target_data</code> only retrieves the column "target".</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">get_target_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="a23fed6a-0c58-4519-975e-98260295e7eb"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#a23fed6a-0c58-4519-975e-98260295e7eb');

            setTimeout(function() {
                var nbb_cell_id = 50;
                var nbb_unformatted_code = "dataset.get_target_data.head(2)";
                var nbb_formatted_code = "dataset.get_target_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">get_single_target_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="fd3a199d-e886-4f93-a455-83483e54b913"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#fd3a199d-e886-4f93-a455-83483e54b913');

            setTimeout(function() {
                var nbb_cell_id = 51;
                var nbb_unformatted_code = "dataset.get_single_target_data.head(2)";
                var nbb_formatted_code = "dataset.get_single_target_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_era_batch</code> will return a <code>tf.Tensor</code> or <code>np.ndarray</code> with feature data and target data for one or more eras. Convenient for creating neural network DataGenerators.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_era_batch</span><span class="p">([</span><span class="s1">&#39;era1&#39;</span><span class="p">],</span> <span class="n">convert_to_tf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(10, 310), dtype=float16, numpy=
array([[0.  , 0.5 , 0.25, ..., 1.  , 0.5 , 0.75],
       [0.  , 0.  , 0.  , ..., 0.  , 0.25, 1.  ],
       [0.25, 0.5 , 0.25, ..., 0.  , 0.25, 0.75],
       ...,
       [0.25, 1.  , 1.  , ..., 0.75, 0.5 , 0.25],
       [0.5 , 0.5 , 0.5 , ..., 0.  , 0.  , 0.  ],
       [0.5 , 1.  , 1.  , ..., 1.  , 1.  , 0.75]], dtype=float16)&gt;</pre>
</div>

</div>

<div class="output_area">




<div id="badfb8c2-b06f-4f9f-a59a-f6ea347848c9"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#badfb8c2-b06f-4f9f-a59a-f6ea347848c9');

            setTimeout(function() {
                var nbb_cell_id = 52;
                var nbb_unformatted_code = "X, y = dataset.get_era_batch(['era1'], convert_to_tf=True, dtype=tf.float16)\nX";
                var nbb_formatted_code = "X, y = dataset.get_era_batch([\"era1\"], convert_to_tf=True, dtype=tf.float16)\nX";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For people training autoencoders + MLP you can get a target that contains 3 elements: features, targets and targets. Just define <code>aemlp_batch=True</code>.
More info on these kinds this setup: <a href="https://forum.numer.ai/t/autoencoder-and-multitask-mlp-on-new-dataset-from-kaggle-jane-street/4338">AutoEncoder and multitask MLP on new dataset forum post</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_era_batch</span><span class="p">([</span><span class="s1">&#39;era1&#39;</span><span class="p">],</span> <span class="n">convert_to_tf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">aemlp_batch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;tf.Tensor: shape=(10, 310), dtype=float16, numpy=
 array([[0.  , 0.5 , 0.25, ..., 1.  , 0.5 , 0.75],
        [0.  , 0.  , 0.  , ..., 0.  , 0.25, 1.  ],
        [0.25, 0.5 , 0.25, ..., 0.  , 0.25, 0.75],
        ...,
        [0.25, 1.  , 1.  , ..., 0.75, 0.5 , 0.25],
        [0.5 , 0.5 , 0.5 , ..., 0.  , 0.  , 0.  ],
        [0.5 , 1.  , 1.  , ..., 1.  , 1.  , 0.75]], dtype=float16)&gt;,
 &lt;tf.Tensor: shape=(10, 1), dtype=float16, numpy=
 array([[0.5 ],
        [0.25],
        [0.25],
        [0.25],
        [0.75],
        [0.5 ],
        [0.25],
        [0.25],
        [0.5 ],
        [0.75]], dtype=float16)&gt;,
 &lt;tf.Tensor: shape=(10, 1), dtype=float16, numpy=
 array([[0.5 ],
        [0.25],
        [0.25],
        [0.25],
        [0.75],
        [0.5 ],
        [0.25],
        [0.25],
        [0.5 ],
        [0.75]], dtype=float16)&gt;]</pre>
</div>

</div>

<div class="output_area">




<div id="1533ff83-84db-489a-9992-37738c823231"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#1533ff83-84db-489a-9992-37738c823231');

            setTimeout(function() {
                var nbb_cell_id = 53;
                var nbb_unformatted_code = "X, y = dataset.get_era_batch(['era1'], convert_to_tf=True, aemlp_batch=True, dtype=tf.float16)\ny";
                var nbb_formatted_code = "X, y = dataset.get_era_batch(\n    [\"era1\"], convert_to_tf=True, aemlp_batch=True, dtype=tf.float16\n)\ny";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.aux_cols</code> denotes all columns that are not features, targets or prediction columns.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">aux_cols</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;id&#39;, &#39;era&#39;, &#39;data_type&#39;]</pre>
</div>

</div>

<div class="output_area">




<div id="33606f02-be84-445c-9774-cd787e80ca05"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#33606f02-be84-445c-9774-cd787e80ca05');

            setTimeout(function() {
                var nbb_cell_id = 54;
                var nbb_unformatted_code = "dataset.aux_cols";
                var nbb_formatted_code = "dataset.aux_cols";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">get_aux_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>era</th>
      <th>data_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>era1</td>
      <td>train</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>era1</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="a7f3bb56-3760-4d6a-8a65-07fd18059b74"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#a7f3bb56-3760-4d6a-8a65-07fd18059b74');

            setTimeout(function() {
                var nbb_cell_id = 55;
                var nbb_unformatted_code = "dataset.get_aux_data.head(2)";
                var nbb_formatted_code = "dataset.get_aux_data.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Arbitrary <code>.json</code> metadata can be stored into the <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a>. All metadata can also be exported to a <code>json</code> file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">export_json_metadata</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 Exporting metadata to config.json 📁
</pre>

</div>

</div>

<div class="output_area">




<div id="3e9aae4d-8659-4635-846f-312f64cda6fb"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#3e9aae4d-8659-4635-846f-312f64cda6fb');

            setTimeout(function() {
                var nbb_cell_id = 56;
                var nbb_unformatted_code = "dataset.export_json_metadata(\"config.json\")";
                var nbb_formatted_code = "dataset.export_json_metadata(\"config.json\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">import_json_metadata</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 Importing metadata from config.json 📁
</pre>

</div>

</div>

<div class="output_area">




<div id="2fb5094b-8045-4ba9-95a0-273727ef436c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#2fb5094b-8045-4ba9-95a0-273727ef436c');

            setTimeout(function() {
                var nbb_cell_id = 57;
                var nbb_unformatted_code = "dataset.import_json_metadata(\"config.json\")";
                var nbb_formatted_code = "dataset.import_json_metadata(\"config.json\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">multi_target</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="efc0ce35-35db-4e6a-9678-0da98df98377"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#efc0ce35-35db-4e6a-9678-0da98df98377');

            setTimeout(function() {
                var nbb_cell_id = 58;
                var nbb_unformatted_code = "assert dataset.meta.version == 1\nassert not dataset.meta.multi_target";
                var nbb_formatted_code = "assert dataset.meta.version == 1\nassert not dataset.meta.multi_target";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> inherits from <code>pd.DataFrame</code> you still have all functionality of a normal DataFrame at your disposal, including copying.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf2</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">dataf2</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="918eda2a-f425-42a0-9dbd-3a34010c63a8"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#918eda2a-f425-42a0-9dbd-3a34010c63a8');

            setTimeout(function() {
                var nbb_cell_id = 59;
                var nbb_unformatted_code = "dataf2 = dataset.copy()\nassert dataf2.equals(dataset)";
                var nbb_formatted_code = "dataf2 = dataset.copy()\nassert dataf2.equals(dataset)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> dynamically tracks which feature, target, aux and prediction columns there are at when initialized. For example, here we add predictions and upon <a href="/numerai_blocks/numerframe.html#NumerFrame"><code>NumerFrame</code></a> initialization the column will be contained in <code>prediction_cols</code>. Prediction columns are all column names that start with <code>prediction</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;prediction_test_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
<span class="n">new_dataset</span> <span class="o">=</span> <span class="n">NumerFrame</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">new_dataset</span><span class="o">.</span><span class="n">prediction_cols</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;prediction_test_1&quot;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">new_dataset</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="e5ac5e79-b754-4db3-ad56-3be903dce0e9"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e5ac5e79-b754-4db3-ad56-3be903dce0e9');

            setTimeout(function() {
                var nbb_cell_id = 60;
                var nbb_unformatted_code = "dataset.loc[:, \"prediction_test_1\"] = np.random.uniform(size=len(dataset))\nnew_dataset = NumerFrame(dataset)\nassert new_dataset.prediction_cols == [\"prediction_test_1\"]\nassert new_dataset.meta.version == 1";
                var nbb_formatted_code = "dataset.loc[:, \"prediction_test_1\"] = np.random.uniform(size=len(dataset))\nnew_dataset = NumerFrame(dataset)\nassert new_dataset.prediction_cols == [\"prediction_test_1\"]\nassert new_dataset.meta.version == 1";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Arbitrary columns van be retrieved with <code>.get_column_selection</code>. The input argument can be either a string or a list with column names.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selection1</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_column_selection</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">selection1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="03ed1f6a-3fdb-4c26-81f6-6e1d2040554d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#03ed1f6a-3fdb-4c26-81f6-6e1d2040554d');

            setTimeout(function() {
                var nbb_cell_id = 61;
                var nbb_unformatted_code = "selection1 = dataset.get_column_selection(\"id\")\nselection1.head(2)";
                var nbb_formatted_code = "selection1 = dataset.get_column_selection(\"id\")\nselection1.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selection2</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_column_selection</span><span class="p">([</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;prediction_test_1&quot;</span><span class="p">])</span>
<span class="n">selection2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>prediction_test_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n000315175b67977</td>
      <td>0.130864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>n0014af834a96cdd</td>
      <td>0.484529</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="639f5de8-b303-4c04-9092-64431a1073ef"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#639f5de8-b303-4c04-9092-64431a1073ef');

            setTimeout(function() {
                var nbb_cell_id = 62;
                var nbb_unformatted_code = "selection2 = dataset.get_column_selection([\"id\", \"prediction_test_1\"])\nselection2.head(2)";
                var nbb_formatted_code = "selection2 = dataset.get_column_selection([\"id\", \"prediction_test_1\"])\nselection2.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selection1</span><span class="p">,</span> <span class="n">NumerFrame</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="50e706c4-6ea0-4dc8-ab0a-c2c053675086"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#50e706c4-6ea0-4dc8-ab0a-c2c053675086');

            setTimeout(function() {
                var nbb_cell_id = 63;
                var nbb_unformatted_code = "assert isinstance(selection1, NumerFrame)";
                var nbb_formatted_code = "assert isinstance(selection1, NumerFrame)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For convenience we can get a feature, target pair with one method. <code>X</code> will have all feature data and <code>y</code> all target data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_feature_target_pair</span><span class="p">(</span><span class="n">multi_target</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature_intelligence1</th>
      <th>feature_intelligence2</th>
      <th>feature_intelligence3</th>
      <th>feature_intelligence4</th>
      <th>feature_intelligence5</th>
      <th>feature_intelligence6</th>
      <th>feature_intelligence7</th>
      <th>feature_intelligence8</th>
      <th>feature_intelligence9</th>
      <th>feature_intelligence10</th>
      <th>...</th>
      <th>feature_wisdom37</th>
      <th>feature_wisdom38</th>
      <th>feature_wisdom39</th>
      <th>feature_wisdom40</th>
      <th>feature_wisdom41</th>
      <th>feature_wisdom42</th>
      <th>feature_wisdom43</th>
      <th>feature_wisdom44</th>
      <th>feature_wisdom45</th>
      <th>feature_wisdom46</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.00</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.75</td>
      <td>0.75</td>
      <td>...</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>0.50</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.25</td>
      <td>0.50</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.75</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 310 columns</p>
</div>
</div>

</div>

<div class="output_area">




<div id="28da0ea3-8b77-4737-b4ab-72b19e1f822d"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#28da0ea3-8b77-4737-b4ab-72b19e1f822d');

            setTimeout(function() {
                var nbb_cell_id = 64;
                var nbb_unformatted_code = "X, y = dataset.get_feature_target_pair(multi_target=False)\nX.head(2)";
                var nbb_formatted_code = "X, y = dataset.get_feature_target_pair(multi_target=False)\nX.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="06037a85-927e-4921-b4f0-a4f88ec2c8dc"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#06037a85-927e-4921-b4f0-a4f88ec2c8dc');

            setTimeout(function() {
                var nbb_cell_id = 65;
                var nbb_unformatted_code = "y.head(2)";
                var nbb_formatted_code = "y.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>
 

