---

title: Numerai Blocks


keywords: fastai
sidebar: home_sidebar

summary: "Tools for solid Numerai pipelines"
description: "Tools for solid Numerai pipelines"
nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Install">1. Install<a class="anchor-link" href="#1.-Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install numerai-blocks</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-How-to-use">2. How to use<a class="anchor-link" href="#2.-How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.1.-Contents">2.1. Contents<a class="anchor-link" href="#2.1.-Contents"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example and educational notebooks can be found in the <code>edu_nbs</code> directory. Development notebooks are in the <code>nbs</code> directory.</p>
<p>The library features the following tools to build your Numerai pipelines:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Downloaders</li>
<li>Dataset</li>
<li>Preprocessing</li>
<li>Model</li>
<li>ModelPipeline and ModelPipelineCollection</li>
<li>Postprocessing</li>
<li>Evaluators</li>
<li>Key (containing authentication info)</li>
<li>Submittors</li>
<li>Staking functionality</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2.-Quick-Examples">2.2. Quick Examples<a class="anchor-link" href="#2.2.-Quick-Examples"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.2.1.-Numerai-Classic">2.2.1. Numerai Classic<a class="anchor-link" href="#2.2.1.-Numerai-Classic"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Download version 2 data</span>
<span class="c1"># downloader = NumeraiClassicDownloader(&quot;data&quot;)</span>
<span class="c1"># downloader.download_inference_data(&quot;current_round&quot;)</span>
<span class="c1">#</span>
<span class="c1"># # Initialize Dataset</span>
<span class="c1"># metadata = {&quot;version&quot;: 2, &quot;model_name&quot;: &quot;MY_MODEL&quot;}</span>
<span class="c1"># dataset = create_dataset(file_path=&quot;data/current_round/numerai_tournament_data.parquet&quot;, **metadata)</span>
<span class="c1">#</span>
<span class="c1"># # Define and run pipeline</span>
<span class="c1"># model1 = JoblibModel(model_directory=&quot;dir_with_joblib_models&quot;,</span>
<span class="c1">#                      model_name=&quot;test_model&quot;)</span>
<span class="c1"># pipeline = ModelPipeline(pipeline_name=dataset.base_model_name,</span>
<span class="c1">#                              preprocessors=[],</span>
<span class="c1">#                              models=[model1],</span>
<span class="c1">#                              postprocessors=[FeatureNeutralizer(proportion=0.5)])</span>
<span class="c1"># dataset = pipeline(dataset)</span>
<span class="c1">#</span>
<span class="c1"># # Submit</span>
<span class="c1"># key = load_key_from_json(&quot;my_key.json&quot;)</span>
<span class="c1"># submittor = NumeraiClassicSubmittor(directory_path=&quot;sub_current_round&quot;, key=key)</span>
<span class="c1"># submittor.full_submission(dataf=dataset.dataf,</span>
<span class="c1">#                           cols=&quot;prediction_test_model_neutralized_0.5&quot;,</span>
<span class="c1">#                           file_name=f&quot;{dataset.model_name}.csv&quot;,</span>
<span class="c1">#                           model_name=dataset.model_name,</span>
<span class="c1">#                           version=dataset.version</span>
<span class="c1">#                           )</span>
<span class="c1">#</span>
<span class="c1"># # Remove data and subs</span>
<span class="c1"># downloader.remove_base_directory()</span>
<span class="c1"># submittor.remove_base_directory()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="a02fc2e0-feec-42d4-83da-a71909aed9de"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#a02fc2e0-feec-42d4-83da-a71909aed9de');

            setTimeout(function() {
                var nbb_cell_id = 3;
                var nbb_unformatted_code = "# slow\n# Download version 2 data\n# downloader = NumeraiClassicDownloader(\"data\")\n# downloader.download_inference_data(\"current_round\")\n# \n# # Initialize Dataset\n# metadata = {\"version\": 2, \"model_name\": \"MY_MODEL\"}\n# dataset = create_dataset(file_path=\"data/current_round/numerai_tournament_data.parquet\", **metadata)\n# \n# # Define and run pipeline\n# model1 = JoblibModel(model_directory=\"dir_with_joblib_models\",\n#                      model_name=\"test_model\")\n# pipeline = ModelPipeline(pipeline_name=dataset.base_model_name,\n#                              preprocessors=[],\n#                              models=[model1],\n#                              postprocessors=[FeatureNeutralizer(proportion=0.5)])\n# dataset = pipeline(dataset)\n# \n# # Submit\n# key = load_key_from_json(\"my_key.json\")\n# submittor = NumeraiClassicSubmittor(directory_path=\"sub_current_round\", key=key)\n# submittor.full_submission(dataf=dataset.dataf,\n#                           cols=\"prediction_test_model_neutralized_0.5\",\n#                           file_name=f\"{dataset.model_name}.csv\",\n#                           model_name=dataset.model_name,\n#                           version=dataset.version\n#                           )\n# \n# # Remove data and subs\n# downloader.remove_base_directory()\n# submittor.remove_base_directory()";
                var nbb_formatted_code = "# slow\n# Download version 2 data\n# downloader = NumeraiClassicDownloader(\"data\")\n# downloader.download_inference_data(\"current_round\")\n#\n# # Initialize Dataset\n# metadata = {\"version\": 2, \"model_name\": \"MY_MODEL\"}\n# dataset = create_dataset(file_path=\"data/current_round/numerai_tournament_data.parquet\", **metadata)\n#\n# # Define and run pipeline\n# model1 = JoblibModel(model_directory=\"dir_with_joblib_models\",\n#                      model_name=\"test_model\")\n# pipeline = ModelPipeline(pipeline_name=dataset.base_model_name,\n#                              preprocessors=[],\n#                              models=[model1],\n#                              postprocessors=[FeatureNeutralizer(proportion=0.5)])\n# dataset = pipeline(dataset)\n#\n# # Submit\n# key = load_key_from_json(\"my_key.json\")\n# submittor = NumeraiClassicSubmittor(directory_path=\"sub_current_round\", key=key)\n# submittor.full_submission(dataf=dataset.dataf,\n#                           cols=\"prediction_test_model_neutralized_0.5\",\n#                           file_name=f\"{dataset.model_name}.csv\",\n#                           model_name=dataset.model_name,\n#                           version=dataset.version\n#                           )\n#\n# # Remove data and subs\n# downloader.remove_base_directory()\n# submittor.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üíª Structure before starting                                                                        
<span style="color: #808080; text-decoration-color: #808080">‚î£‚îÅ‚îÅ </span>üìÑ my_key.json                                                                                  
<span style="color: #808080; text-decoration-color: #808080">‚îó‚îÅ‚îÅ </span>üìÅ dir_with_joblib_models                                                                       
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model1.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model2.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model3.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model4.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚îó‚îÅ‚îÅ </span>üìÑ model5.joblib                                                                            
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üíª Structure after submitting                                                                       
<span style="color: #808080; text-decoration-color: #808080">‚î£‚îÅ‚îÅ </span>üìÅ data                                                                                         
<span style="color: #808080; text-decoration-color: #808080">‚îÉ   ‚îó‚îÅ‚îÅ </span>üìÅ current_round                                                                            
<span style="color: #808080; text-decoration-color: #808080">‚îÉ       ‚îó‚îÅ‚îÅ </span>üìÑ numerai_tournament_data.parquet                                                      
<span style="color: #808080; text-decoration-color: #808080">‚î£‚îÅ‚îÅ </span>üìÅ sub_current_round                                                                            
<span style="color: #808080; text-decoration-color: #808080">‚îÉ   ‚îó‚îÅ‚îÅ </span>üìÑ MY_MODEL.csv                                                                             
<span style="color: #808080; text-decoration-color: #808080">‚î£‚îÅ‚îÅ </span>üìÑ my_key.json                                                                                  
<span style="color: #808080; text-decoration-color: #808080">‚îó‚îÅ‚îÅ </span>üìÅ dir_with_joblib_models                                                                       
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model1.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model2.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model3.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ model4.joblib                                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚îó‚îÅ‚îÅ </span>üìÑ model5.joblib                                                                            
</pre>

</div>

</div>

<div class="output_area">




<div id="3588cfe1-c780-4ff5-8d14-8678fd740163"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#3588cfe1-c780-4ff5-8d14-8678fd740163');

            setTimeout(function() {
                var nbb_cell_id = 4;
                var nbb_unformatted_code = "# hide_input\nfrom rich.console import Console\nfrom rich.tree import Tree\n\nconsole = Console(record=True, width=100)\n\ntree = Tree(\":computer: Structure before starting\", guide_style=\"bold bright_black\")\ntree.add(\":page_facing_up: my_key.json\")\nmodel_tree = tree.add(\":file_folder: dir_with_joblib_models\")\nmodel_tree.add(\":page_facing_up: model1.joblib\")\nmodel_tree.add(\":page_facing_up: model2.joblib\")\nmodel_tree.add(\":page_facing_up: model3.joblib\")\nmodel_tree.add(\":page_facing_up: model4.joblib\")\nmodel_tree.add(\":page_facing_up: model5.joblib\")\n\nconsole.print(tree)\n\ntree2 = Tree(\":computer: Structure after submitting\", guide_style=\"bold bright_black\")\ndata_tree = tree2.add(\":file_folder: data\")\ncurrent_tree = data_tree.add(\":file_folder: current_round\")\ncurrent_tree.add(\":page_facing_up: numerai_tournament_data.parquet\")\nsub_tree = tree2.add(\":file_folder: sub_current_round\")\nsub_tree.add(\":page_facing_up: MY_MODEL.csv\")\ntree2.add(\":page_facing_up: my_key.json\")\nmodel_tree = tree2.add(\":file_folder: dir_with_joblib_models\")\nmodel_tree.add(\":page_facing_up: model1.joblib\")\nmodel_tree.add(\":page_facing_up: model2.joblib\")\nmodel_tree.add(\":page_facing_up: model3.joblib\")\nmodel_tree.add(\":page_facing_up: model4.joblib\")\nmodel_tree.add(\":page_facing_up: model5.joblib\")\n\nconsole.print(tree2)";
                var nbb_formatted_code = "# hide_input\nfrom rich.console import Console\nfrom rich.tree import Tree\n\nconsole = Console(record=True, width=100)\n\ntree = Tree(\":computer: Structure before starting\", guide_style=\"bold bright_black\")\ntree.add(\":page_facing_up: my_key.json\")\nmodel_tree = tree.add(\":file_folder: dir_with_joblib_models\")\nmodel_tree.add(\":page_facing_up: model1.joblib\")\nmodel_tree.add(\":page_facing_up: model2.joblib\")\nmodel_tree.add(\":page_facing_up: model3.joblib\")\nmodel_tree.add(\":page_facing_up: model4.joblib\")\nmodel_tree.add(\":page_facing_up: model5.joblib\")\n\nconsole.print(tree)\n\ntree2 = Tree(\":computer: Structure after submitting\", guide_style=\"bold bright_black\")\ndata_tree = tree2.add(\":file_folder: data\")\ncurrent_tree = data_tree.add(\":file_folder: current_round\")\ncurrent_tree.add(\":page_facing_up: numerai_tournament_data.parquet\")\nsub_tree = tree2.add(\":file_folder: sub_current_round\")\nsub_tree.add(\":page_facing_up: MY_MODEL.csv\")\ntree2.add(\":page_facing_up: my_key.json\")\nmodel_tree = tree2.add(\":file_folder: dir_with_joblib_models\")\nmodel_tree.add(\":page_facing_up: model1.joblib\")\nmodel_tree.add(\":page_facing_up: model2.joblib\")\nmodel_tree.add(\":page_facing_up: model3.joblib\")\nmodel_tree.add(\":page_facing_up: model4.joblib\")\nmodel_tree.add(\":page_facing_up: model5.joblib\")\n\nconsole.print(tree2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.2.2.-Numerai-Signals">2.2.2. Numerai Signals<a class="anchor-link" href="#2.2.2.-Numerai-Signals"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="0d720b41-d343-4395-9d96-16ed8f396180"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#0d720b41-d343-4395-9d96-16ed8f396180');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "# slow";
                var nbb_formatted_code = "# slow";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Contributing">Contributing<a class="anchor-link" href="#Contributing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After you clone this repository, please run <code>nbdev_install_git_hooks</code> in your terminal. This sets up git hooks, which clean up the notebooks to remove the extraneous stuff stored in the notebooks (e.g. which cells you ran) which causes unnecessary merge conflicts.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Branch-structure">Branch structure<a class="anchor-link" href="#Branch-structure"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Branch structure                                                                                    
<span style="color: #808080; text-decoration-color: #808080">‚îó‚îÅ‚îÅ </span>üì¶ main (release)                                                                               
<span style="color: #808080; text-decoration-color: #808080">    ‚îó‚îÅ‚îÅ </span>üë®‚Äçüíª dev                                                                                    
<span style="color: #808080; text-decoration-color: #808080">        ‚î£‚îÅ‚îÅ </span>‚ú® feature/1                                                                            
<span style="color: #808080; text-decoration-color: #808080">        ‚î£‚îÅ‚îÅ </span>‚ú® feature/2                                                                            
<span style="color: #808080; text-decoration-color: #808080">        ‚îó‚îÅ‚îÅ </span>‚ú® feature/3                                                                            
</pre>

</div>

</div>

<div class="output_area">




<div id="dfb6d8c1-2b5e-40cf-993b-1a1cef536140"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#dfb6d8c1-2b5e-40cf-993b-1a1cef536140');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\"Branch structure\", guide_style=\"bold bright_black\")\n\nmain_tree = tree.add(\"\ud83d\udce6 main (release)\", guide_style=\"bright_black\")\ndev_tree = main_tree.add(\"\ud83d\udc68\u200d\ud83d\udcbb dev\")\nfeature_tree = dev_tree.add(\":sparkles: feature/1\")\ndev_tree.add(\":sparkles: feature/2\")\ndev_tree.add(\":sparkles: feature/3\")\n\nconsole.print(tree)";
                var nbb_formatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\"Branch structure\", guide_style=\"bold bright_black\")\n\nmain_tree = tree.add(\"\ud83d\udce6 main (release)\", guide_style=\"bright_black\")\ndev_tree = main_tree.add(\"\ud83d\udc68\u200d\ud83d\udcbb dev\")\nfeature_tree = dev_tree.add(\":sparkles: feature/1\")\ndev_tree.add(\":sparkles: feature/2\")\ndev_tree.add(\":sparkles: feature/3\")\n\nconsole.print(tree)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

