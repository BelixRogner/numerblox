---

title: Download


keywords: fastai
sidebar: home_sidebar

summary: "Functionality to easily download data to your environment."
description: "Functionality to easily download data to your environment."
nb_path: "nbs/01_download.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_download.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="0.-BaseIO">0. BaseIO<a class="anchor-link" href="#0.-BaseIO"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are common methods needed for <code>Downloaders</code> and <code>Submittors</code>. <a href="/numerblox/download.html#BaseIO"><code>BaseIO</code></a> implements this functionality and allows us to make abstract base classes. Namely, <a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a> and <a href="/numerblox/submission.html#BaseSubmitter"><code>BaseSubmitter</code></a> (implemented in <code>submission</code> section).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseIO" class="doc_header"><code>class</code> <code>BaseIO</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/download.py#L28" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseIO</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <code>ABC</code></p>
</blockquote>
<p>Basic functionality for IO (downloading and uploading).</p>
<p>| :param directory_path: Base folder for IO. Will be created if it does not exist.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="7319523e-be4b-483c-89a6-2edae2d7bb4c"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7319523e-be4b-483c-89a6-2edae2d7bb4c');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "# export\n@typechecked\nclass BaseIO(ABC):\n    \"\"\"\n    Basic functionality for IO (downloading and uploading).\n\n    | :param directory_path: Base folder for IO. Will be created if it does not exist.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        self.dir = Path(directory_path)\n        self._create_directory()\n\n    def remove_base_directory(self):\n        \"\"\"Remove directory with all contents.\"\"\"\n        abs_path = self.dir.resolve()\n        rich_print(\n            f\":warning: [red]Deleting directory for '{self.__class__.__name__}[/red]' :warning:\\nPath: '{abs_path}'\"\n        )\n        shutil.rmtree(abs_path)\n\n    def download_file_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Get file from GCS bucket and download to local directory.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        blob.download_to_filename(gcs_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Downloaded GCS object '{gcs_path}' from bucket '{blob.bucket.id}' to local directory '{blob_path}'. :page_facing_up: :cloud:\"\n        )\n\n    def upload_file_to_gcs(self, bucket_name: str, gcs_path: str, local_path: str):\n        \"\"\"\n        Upload file to some GCS bucket.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Local file '{local_path}' uploaded to '{gcs_path}' in bucket {blob.bucket.id}:page_facing_up: :cloud:\"\n        )\n\n    def download_directory_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Copy full directory from GCS bucket to local environment.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        for gcs_file in glob.glob(gcs_path + \"/**\", recursive=True):\n            if os.path.isfile(gcs_file):\n                blob.download_to_filename(blob_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{gcs_path}' from bucket '{blob.bucket.id}' downloaded to '{blob_path}' :folder: :cloud:\"\n        )\n\n    def upload_directory_to_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Upload full base directory to GCS bucket.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        for local_path in glob.glob(str(self.dir) + \"/**\", recursive=True):\n            if os.path.isfile(local_path):\n                blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{self.dir}' uploaded to '{gcs_path}' in bucket {blob.bucket.id} :folder: :cloud:\"\n        )\n\n    def _get_gcs_blob(self, bucket_name: str, blob_path: str) -> storage.Blob:\n        \"\"\" Create blob that interacts with Google Cloud Storage (GCS). \"\"\"\n        client = storage.Client()\n        # https://console.cloud.google.com/storage/browser/[bucket_name]\n        bucket = client.get_bucket(bucket_name)\n        blob = bucket.blob(blob_path)\n        return blob\n\n    def _append_folder(self, folder: str) -> Path:\n        \"\"\"\n        Return base directory Path object appended with 'folder'.\n        Create directory if it does not exist.\n        \"\"\"\n        dir = Path(self.dir / folder)\n        dir.mkdir(parents=True, exist_ok=True)\n        return dir\n\n    def _create_directory(self):\n        \"\"\" Create base directory if it does not exist. \"\"\"\n        if not self.dir.is_dir():\n            rich_print(\n                f\"No existing directory found at '[blue]{self.dir}[/blue]'. Creating directory...\"\n            )\n            self.dir.mkdir(parents=True, exist_ok=True)\n\n    @property\n    def get_all_files(self) -> list:\n        \"\"\" Return all paths of contents in directory. \"\"\"\n        return list(self.dir.iterdir())\n\n    @property\n    def is_empty(self) -> bool:\n        \"\"\" Check if directory is empty. \"\"\"\n        return not bool(self.get_all_files)";
                var nbb_formatted_code = "# export\n@typechecked\nclass BaseIO(ABC):\n    \"\"\"\n    Basic functionality for IO (downloading and uploading).\n\n    | :param directory_path: Base folder for IO. Will be created if it does not exist.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        self.dir = Path(directory_path)\n        self._create_directory()\n\n    def remove_base_directory(self):\n        \"\"\"Remove directory with all contents.\"\"\"\n        abs_path = self.dir.resolve()\n        rich_print(\n            f\":warning: [red]Deleting directory for '{self.__class__.__name__}[/red]' :warning:\\nPath: '{abs_path}'\"\n        )\n        shutil.rmtree(abs_path)\n\n    def download_file_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Get file from GCS bucket and download to local directory.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        blob.download_to_filename(gcs_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Downloaded GCS object '{gcs_path}' from bucket '{blob.bucket.id}' to local directory '{blob_path}'. :page_facing_up: :cloud:\"\n        )\n\n    def upload_file_to_gcs(self, bucket_name: str, gcs_path: str, local_path: str):\n        \"\"\"\n        Upload file to some GCS bucket.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Local file '{local_path}' uploaded to '{gcs_path}' in bucket {blob.bucket.id}:page_facing_up: :cloud:\"\n        )\n\n    def download_directory_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Copy full directory from GCS bucket to local environment.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        for gcs_file in glob.glob(gcs_path + \"/**\", recursive=True):\n            if os.path.isfile(gcs_file):\n                blob.download_to_filename(blob_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{gcs_path}' from bucket '{blob.bucket.id}' downloaded to '{blob_path}' :folder: :cloud:\"\n        )\n\n    def upload_directory_to_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Upload full base directory to GCS bucket.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        for local_path in glob.glob(str(self.dir) + \"/**\", recursive=True):\n            if os.path.isfile(local_path):\n                blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{self.dir}' uploaded to '{gcs_path}' in bucket {blob.bucket.id} :folder: :cloud:\"\n        )\n\n    def _get_gcs_blob(self, bucket_name: str, blob_path: str) -> storage.Blob:\n        \"\"\"Create blob that interacts with Google Cloud Storage (GCS).\"\"\"\n        client = storage.Client()\n        # https://console.cloud.google.com/storage/browser/[bucket_name]\n        bucket = client.get_bucket(bucket_name)\n        blob = bucket.blob(blob_path)\n        return blob\n\n    def _append_folder(self, folder: str) -> Path:\n        \"\"\"\n        Return base directory Path object appended with 'folder'.\n        Create directory if it does not exist.\n        \"\"\"\n        dir = Path(self.dir / folder)\n        dir.mkdir(parents=True, exist_ok=True)\n        return dir\n\n    def _create_directory(self):\n        \"\"\"Create base directory if it does not exist.\"\"\"\n        if not self.dir.is_dir():\n            rich_print(\n                f\"No existing directory found at '[blue]{self.dir}[/blue]'. Creating directory...\"\n            )\n            self.dir.mkdir(parents=True, exist_ok=True)\n\n    @property\n    def get_all_files(self) -> list:\n        \"\"\"Return all paths of contents in directory.\"\"\"\n        return list(self.dir.iterdir())\n\n    @property\n    def is_empty(self) -> bool:\n        \"\"\"Check if directory is empty.\"\"\"\n        return not bool(self.get_all_files)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-BaseDownloader">1. BaseDownloader<a class="anchor-link" href="#1.-BaseDownloader"> </a></h2><p><a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a> is an object which implements logic common to all downloaders.</p>
<p>To implement a new Downloader, you should inherit from <a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a> and be sure to implement at least methods for <code>.download_training_data</code> and <code>.download_inference_data</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseDownloader" class="doc_header"><code>class</code> <code>BaseDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/download.py#L133" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <a href="/numerblox/download.html#BaseIO"><code>BaseIO</code></a></p>
</blockquote>
<p>Abstract base class for downloaders.</p>
<p>| :param directory_path: Base folder to download files to.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="65bf81f0-48ce-4191-965f-c44153055dd1"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#65bf81f0-48ce-4191-965f-c44153055dd1');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# export\n@typechecked\nclass BaseDownloader(BaseIO):\n    \"\"\"\n    Abstract base class for downloaders.\n\n    | :param directory_path: Base folder to download files to.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    @abstractmethod\n    def download_training_data(self, *args, **kwargs):\n        \"\"\" Download all necessary files needed for training. \"\"\"\n        ...\n\n    @abstractmethod\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\" Download minimal amount of files needed for weekly inference. \"\"\"\n        ...\n\n    @staticmethod\n    def _load_json(file_path: str, verbose=False, *args, **kwargs) -> dict:\n        \"\"\" Load JSON from file and return as dictionary. \"\"\"\n        with open(file_path) as json_file:\n            json_data = json.load(json_file, *args, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        return json_data\n\n    def __call__(self, *args, **kwargs):\n        \"\"\"\n        The most common use case will be to get weekly inference data. So calling the class itself returns inference data.\n        \"\"\"\n        self.download_inference_data(*args, **kwargs)";
                var nbb_formatted_code = "# export\n@typechecked\nclass BaseDownloader(BaseIO):\n    \"\"\"\n    Abstract base class for downloaders.\n\n    | :param directory_path: Base folder to download files to.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    @abstractmethod\n    def download_training_data(self, *args, **kwargs):\n        \"\"\"Download all necessary files needed for training.\"\"\"\n        ...\n\n    @abstractmethod\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\"Download minimal amount of files needed for weekly inference.\"\"\"\n        ...\n\n    @staticmethod\n    def _load_json(file_path: str, verbose=False, *args, **kwargs) -> dict:\n        \"\"\"Load JSON from file and return as dictionary.\"\"\"\n        with open(file_path) as json_file:\n            json_data = json.load(json_file, *args, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        return json_data\n\n    def __call__(self, *args, **kwargs):\n        \"\"\"\n        The most common use case will be to get weekly inference data. So calling the class itself returns inference data.\n        \"\"\"\n        self.download_inference_data(*args, **kwargs)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Numerai-Classic">2. Numerai Classic<a class="anchor-link" href="#2.-Numerai-Classic"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NumeraiClassicDownloader" class="doc_header"><code>class</code> <code>NumeraiClassicDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/download.py#L168" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NumeraiClassicDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>WARNING: Version 1 (legacy data) is deprecated. Only supporting version 2+.</p>
<p>| Downloading from NumerAPI for Numerai Classic data.     | :param directory_path: Base folder to download files to.     | All *args, **kwargs will be passed to NumerAPI initialization.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="10018f2b-0c2f-4328-bad9-6b08f5ab34a8"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#10018f2b-0c2f-4328-bad9-6b08f5ab34a8');

            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "# export\nclass NumeraiClassicDownloader(BaseDownloader):\n    \"\"\"\n    WARNING: Version 1 (legacy data) is deprecated. Only supporting version 2+.\n\n    | Downloading from NumerAPI for Numerai Classic data. \\\n    | :param directory_path: Base folder to download files to. \\\n    | All *args, **kwargs will be passed to NumerAPI initialization.\n    \"\"\"\n    def __init__(self, directory_path: str, *args, **kwargs):\n        super().__init__(directory_path=directory_path)\n        self.napi = NumerAPI(*args, **kwargs)\n        self.current_round = self.napi.get_current_round()\n        # NumerAPI filenames corresponding to version, class and data type\n        self.version_mapping = {\n            2: {\n                \"train\": {\n                    \"int8\": [\n                        \"numerai_training_data_int8.parquet\",\n                        \"numerai_validation_data_int8.parquet\"\n                    ],\n                    \"float\": [\n                        \"numerai_training_data.parquet\",\n                        \"numerai_validation_data.parquet\"\n                    ],\n                },\n                \"inference\": {\n                    \"int8\": [\"numerai_tournament_data_int8.parquet\"],\n                    \"float\": [\"numerai_tournament_data.parquet\"]\n                },\n                \"live\": {\n                    \"int8\": ['numerai_live_data_int8.parquet'],\n                    \"float\": ['numerai_live_data.parquet']\n                },\n                \"example\": [\n                    \"example_predictions.parquet\",\n                    \"example_validation_predictions.parquet\",\n                ],\n            },\n        }\n\n    def download_training_data(\n        self, subfolder: str = \"\", version: int = 2, int8: bool = False\n    ):\n        \"\"\"\n        Get Numerai classic training and validation data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        data_type = \"int8\" if int8 else \"float\"\n        train_val_files = self._get_version_mapping(version)[\"train\"][data_type]\n        for file in train_val_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file))\n            )\n\n    def download_inference_data(\n        self,\n        subfolder: str = \"\",\n        version: int = 2,\n        int8: bool = False,\n        round_num: int = None,\n    ):\n        \"\"\"\n        Get Numerai classic inference (tournament) data.\n        If only minimal live data is needed, consider .download_live_data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        data_type = \"int8\" if int8 else \"float\"\n        inference_files = self._get_version_mapping(version)[\"inference\"][data_type]\n        for file in inference_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file)), round_num=round_num\n            )\n\n    def download_single_dataset(\n        self, filename: str, dest_path: str, round_num: int = None\n    ):\n        \"\"\"\n        Download one of the available datasets through NumerAPI.\n\n        :param filename: Name as listed in NumerAPI (Check NumerAPI().list_datasets() for full overview)\n        :param dest_path: Full path where file will be saved.\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        assert (\n            filename in self.napi.list_datasets()\n        ), f\"Dataset '{filename}' not available in NumerAPI. Available datasets are {self.napi.list_datasets()}.\"\n        rich_print(\n            f\":file_folder: [green]Downloading[/green] '{filename}' :file_folder:\"\n        )\n        self.napi.download_dataset(\n            filename=filename, dest_path=dest_path, round_num=round_num\n        )\n\n    def download_live_data(\n            self,\n            subfolder: str = \"\",\n            version: int = 2,\n            int8: bool = False,\n            round_num: int = None\n    ):\n        \"\"\"\n        Download all live data in specified folder for given version (i.e. minimal data needed for inference).\n\n        :param subfolder: Specify folder to create folder within directory root.\n        Saves in directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        data_type = \"int8\" if int8 else \"float\"\n        live_files = self._get_version_mapping(version)[\"live\"][data_type]\n        for file in live_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file)), round_num=round_num\n            )\n\n    def download_example_data(\n        self, subfolder: str = \"\", version: int = 2, round_num: int = None\n    ):\n        \"\"\"\n        Download all example prediction data in specified folder for given version.\n\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        example_files = self._get_version_mapping(version)[\"example\"]\n        for file in example_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file)), round_num=round_num\n            )\n\n    def get_classic_features(self, subfolder: str = \"\", filename=\"features.json\", *args, **kwargs) -> dict:\n        \"\"\"\n        Download feature overview (stats and feature sets) through NumerAPI and load as dict.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param filename: name for feature overview.\n        Currently defined as 'features.json' in NumerAPI and used as default.\n        *args, **kwargs will be passed to the JSON loader.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        dest_path = str(dir.joinpath(filename))\n        self.download_single_dataset(filename=filename, dest_path=dest_path)\n        json_data = self._load_json(dest_path, *args, **kwargs)\n        return json_data\n\n    def _get_version_mapping(self, version: int) -> dict:\n        \"\"\" Check if data version is supported and return file mapping for version. \"\"\"\n        try:\n            mapping_dictionary = self.version_mapping[version]\n        except KeyError:\n            raise NotImplementedError(\n                f\"Version '{version}' is not available. Available versions are {list(self.version_mapping.keys())}\"\n            )\n        return mapping_dictionary";
                var nbb_formatted_code = "# export\nclass NumeraiClassicDownloader(BaseDownloader):\n    \"\"\"\n    WARNING: Version 1 (legacy data) is deprecated. Only supporting version 2+.\n\n    | Downloading from NumerAPI for Numerai Classic data. \\\n    | :param directory_path: Base folder to download files to. \\\n    | All *args, **kwargs will be passed to NumerAPI initialization.\n    \"\"\"\n\n    def __init__(self, directory_path: str, *args, **kwargs):\n        super().__init__(directory_path=directory_path)\n        self.napi = NumerAPI(*args, **kwargs)\n        self.current_round = self.napi.get_current_round()\n        # NumerAPI filenames corresponding to version, class and data type\n        self.version_mapping = {\n            2: {\n                \"train\": {\n                    \"int8\": [\n                        \"numerai_training_data_int8.parquet\",\n                        \"numerai_validation_data_int8.parquet\",\n                    ],\n                    \"float\": [\n                        \"numerai_training_data.parquet\",\n                        \"numerai_validation_data.parquet\",\n                    ],\n                },\n                \"inference\": {\n                    \"int8\": [\"numerai_tournament_data_int8.parquet\"],\n                    \"float\": [\"numerai_tournament_data.parquet\"],\n                },\n                \"live\": {\n                    \"int8\": [\"numerai_live_data_int8.parquet\"],\n                    \"float\": [\"numerai_live_data.parquet\"],\n                },\n                \"example\": [\n                    \"example_predictions.parquet\",\n                    \"example_validation_predictions.parquet\",\n                ],\n            },\n        }\n\n    def download_training_data(\n        self, subfolder: str = \"\", version: int = 2, int8: bool = False\n    ):\n        \"\"\"\n        Get Numerai classic training and validation data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        data_type = \"int8\" if int8 else \"float\"\n        train_val_files = self._get_version_mapping(version)[\"train\"][data_type]\n        for file in train_val_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file))\n            )\n\n    def download_inference_data(\n        self,\n        subfolder: str = \"\",\n        version: int = 2,\n        int8: bool = False,\n        round_num: int = None,\n    ):\n        \"\"\"\n        Get Numerai classic inference (tournament) data.\n        If only minimal live data is needed, consider .download_live_data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        data_type = \"int8\" if int8 else \"float\"\n        inference_files = self._get_version_mapping(version)[\"inference\"][data_type]\n        for file in inference_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file)), round_num=round_num\n            )\n\n    def download_single_dataset(\n        self, filename: str, dest_path: str, round_num: int = None\n    ):\n        \"\"\"\n        Download one of the available datasets through NumerAPI.\n\n        :param filename: Name as listed in NumerAPI (Check NumerAPI().list_datasets() for full overview)\n        :param dest_path: Full path where file will be saved.\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        assert (\n            filename in self.napi.list_datasets()\n        ), f\"Dataset '{filename}' not available in NumerAPI. Available datasets are {self.napi.list_datasets()}.\"\n        rich_print(\n            f\":file_folder: [green]Downloading[/green] '{filename}' :file_folder:\"\n        )\n        self.napi.download_dataset(\n            filename=filename, dest_path=dest_path, round_num=round_num\n        )\n\n    def download_live_data(\n        self,\n        subfolder: str = \"\",\n        version: int = 2,\n        int8: bool = False,\n        round_num: int = None,\n    ):\n        \"\"\"\n        Download all live data in specified folder for given version (i.e. minimal data needed for inference).\n\n        :param subfolder: Specify folder to create folder within directory root.\n        Saves in directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        data_type = \"int8\" if int8 else \"float\"\n        live_files = self._get_version_mapping(version)[\"live\"][data_type]\n        for file in live_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file)), round_num=round_num\n            )\n\n    def download_example_data(\n        self, subfolder: str = \"\", version: int = 2, round_num: int = None\n    ):\n        \"\"\"\n        Download all example prediction data in specified folder for given version.\n\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        example_files = self._get_version_mapping(version)[\"example\"]\n        for file in example_files:\n            self.download_single_dataset(\n                filename=file, dest_path=str(dir.joinpath(file)), round_num=round_num\n            )\n\n    def get_classic_features(\n        self, subfolder: str = \"\", filename=\"features.json\", *args, **kwargs\n    ) -> dict:\n        \"\"\"\n        Download feature overview (stats and feature sets) through NumerAPI and load as dict.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param filename: name for feature overview.\n        Currently defined as 'features.json' in NumerAPI and used as default.\n        *args, **kwargs will be passed to the JSON loader.\n        \"\"\"\n        dir = self._append_folder(subfolder)\n        dest_path = str(dir.joinpath(filename))\n        self.download_single_dataset(filename=filename, dest_path=dest_path)\n        json_data = self._load_json(dest_path, *args, **kwargs)\n        return json_data\n\n    def _get_version_mapping(self, version: int) -> dict:\n        \"\"\"Check if data version is supported and return file mapping for version.\"\"\"\n        try:\n            mapping_dictionary = self.version_mapping[version]\n        except KeyError:\n            raise NotImplementedError(\n                f\"Version '{version}' is not available. Available versions are {list(self.version_mapping.keys())}\"\n            )\n        return mapping_dictionary";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.1.-Example-usage">2.1. Example usage<a class="anchor-link" href="#2.1.-Example-usage"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This section will explain how to quickly get started with <a href="/numerblox/download.html#NumeraiClassicDownloader"><code>NumeraiClassicDownloader</code></a>.</p>
<p>The more advanced use case of working with GCS (Google Cloud Storage) is discussed in <code>edu_nbs/google_cloud_storage.ipynb</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.1.1.-Training-data">2.1.1. Training data<a class="anchor-link" href="#2.1.1.-Training-data"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Training + validation data for Numerai Classic can be downloaded with effectively 2 lines of code.
Feature stats and overview can be downloaded with <code>.get_classic_features()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialization</span>
<span class="n">train_base_directory</span> <span class="o">=</span> <span class="s2">&quot;test_numclassic_train&quot;</span>
<span class="n">numer_classic_downloader</span> <span class="o">=</span> <span class="n">NumeraiClassicDownloader</span><span class="p">(</span><span class="n">train_base_directory</span><span class="p">)</span>

<span class="c1"># Uncomment line below to download training and validation data</span>
<span class="c1"># numer_classic_downloader.download_training_data(&quot;train_val&quot;, int8=False)</span>

<span class="c1"># Get feature overview (dict)</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">get_classic_features</span><span class="p">()</span>

<span class="c1"># Remove contents (To clean up environment)</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">test_numclassic_train</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 <span style="color: #008000; text-decoration-color: #008000">Downloading</span> <span style="color: #008000; text-decoration-color: #008000">'features.json'</span> 📁
</pre>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-08 14:54:58,160 INFO numerapi.utils: starting download
test_numclassic_train/features.json: 441kB [00:01, 252kB/s]                             
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">⚠ <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'NumeraiClassicDownloader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ⚠
Path: 
<span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/test_numclassic_train'</span>
</pre>

</div>

</div>

<div class="output_area">




<div id="96484404-d674-4204-9c7b-5dff9ab263b4"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#96484404-d674-4204-9c7b-5dff9ab263b4');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "# slow\n# Initialization\ntrain_base_directory = \"test_numclassic_train\"\nnumer_classic_downloader = NumeraiClassicDownloader(train_base_directory)\n\n# Uncomment line below to download training and validation data\n# numer_classic_downloader.download_training_data(\"train_val\", int8=False)\n\n# Get feature overview (dict)\nnumer_classic_downloader.get_classic_features()\n\n# Remove contents (To clean up environment)\nnumer_classic_downloader.remove_base_directory()";
                var nbb_formatted_code = "# slow\n# Initialization\ntrain_base_directory = \"test_numclassic_train\"\nnumer_classic_downloader = NumeraiClassicDownloader(train_base_directory)\n\n# Uncomment line below to download training and validation data\n# numer_classic_downloader.download_training_data(\"train_val\", int8=False)\n\n# Get feature overview (dict)\nnumer_classic_downloader.get_classic_features()\n\n# Remove contents (To clean up environment)\nnumer_classic_downloader.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>For the training example the directory structure will be:</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 test_numclassic_train (base_directory)                                                           
<span style="color: #808080; text-decoration-color: #808080">┣━━ </span>📄 features.json                                                                                
<span style="color: #808080; text-decoration-color: #808080">┗━━ </span>📁 train_val                                                                                    
<span style="color: #808080; text-decoration-color: #808080">    ┣━━ </span>📄 numerai_training_data.parquet                                                            
<span style="color: #808080; text-decoration-color: #808080">    ┗━━ </span>📄 numerai_validation_data.parquet                                                          
</pre>

</div>

</div>

<div class="output_area">




<div id="6de582e1-8b55-4a2f-adbc-b73910c1f43e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#6de582e1-8b55-4a2f-adbc-b73910c1f43e');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {train_base_directory} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\nfolder_tree = tree.add(\":page_facing_up: features.json\")\ntrain_val_tree = tree.add(\":file_folder: train_val\")\ntrain_val_tree.add(\":page_facing_up: numerai_training_data.parquet\")\ntrain_val_tree.add(\":page_facing_up: numerai_validation_data.parquet\")\n\nconsole.print(tree)";
                var nbb_formatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {train_base_directory} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\nfolder_tree = tree.add(\":page_facing_up: features.json\")\ntrain_val_tree = tree.add(\":file_folder: train_val\")\ntrain_val_tree.add(\":page_facing_up: numerai_training_data.parquet\")\ntrain_val_tree.add(\":page_facing_up: numerai_validation_data.parquet\")\n\nconsole.print(tree)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.1.2.-Inference-data">2.1.2. Inference data<a class="anchor-link" href="#2.1.2.-Inference-data"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inference data for the most recent round of Numerai Classic can be downloaded with effectively 2 lines of code.
It can also easily be deleted after you are done with inference by calling <code>.remove_base_directory</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialization</span>
<span class="n">inference_base_dir</span> <span class="o">=</span> <span class="s2">&quot;test_numclassic_inference&quot;</span>
<span class="n">numer_classic_downloader</span> <span class="o">=</span> <span class="n">NumeraiClassicDownloader</span><span class="p">(</span><span class="n">directory_path</span><span class="o">=</span><span class="n">inference_base_dir</span><span class="p">)</span>

<span class="c1"># Download tournament (inference) data</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">download_inference_data</span><span class="p">(</span><span class="s2">&quot;inference&quot;</span><span class="p">,</span> <span class="n">int8</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Remove folder when done with inference</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">test_numclassic_inference</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 <span style="color: #008000; text-decoration-color: #008000">Downloading</span> <span style="color: #008000; text-decoration-color: #008000">'numerai_tournament_data.parquet'</span> 📁
</pre>

</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-03-08 14:55:01,958 INFO numerapi.utils: starting download
test_numclassic_inference/inference/numerai_tournament_data.parquet: 582MB [02:24, 4.02MB/s]                              
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">⚠ <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'NumeraiClassicDownloader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ⚠
Path: <span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/test_numclassic_in</span>
<span style="color: #008000; text-decoration-color: #008000">ference'</span>
</pre>

</div>

</div>

<div class="output_area">




<div id="17bfa87c-87af-4577-be5b-e6f0403e14cd"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#17bfa87c-87af-4577-be5b-e6f0403e14cd');

            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "# slow\n# Initialization\ninference_base_dir = \"test_numclassic_inference\"\nnumer_classic_downloader = NumeraiClassicDownloader(directory_path=inference_base_dir)\n\n# Download tournament (inference) data\nnumer_classic_downloader.download_inference_data(\"inference\", int8=False)\n\n# Remove folder when done with inference\nnumer_classic_downloader.remove_base_directory()";
                var nbb_formatted_code = "# slow\n# Initialization\ninference_base_dir = \"test_numclassic_inference\"\nnumer_classic_downloader = NumeraiClassicDownloader(directory_path=inference_base_dir)\n\n# Download tournament (inference) data\nnumer_classic_downloader.download_inference_data(\"inference\", int8=False)\n\n# Remove folder when done with inference\nnumer_classic_downloader.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>For the inference example the directory structure will be:</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">📁 test_numclassic_inference (base_directory)                                                       
<span style="color: #808080; text-decoration-color: #808080">┗━━ </span>📁 inference                                                                                    
<span style="color: #808080; text-decoration-color: #808080">    ┗━━ </span>📄 numerai_tournament_data.parquet                                                          
</pre>

</div>

</div>

<div class="output_area">




<div id="d0379d1c-5916-45ab-8590-75ffba111907"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d0379d1c-5916-45ab-8590-75ffba111907');

            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {inference_base_dir} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\ninference_tree = tree.add(\":file_folder: inference\")\ninference_tree.add(\":page_facing_up: numerai_tournament_data.parquet\")\n\nconsole.print(tree)";
                var nbb_formatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {inference_base_dir} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\ninference_tree = tree.add(\":file_folder: inference\")\ninference_tree.add(\":page_facing_up: numerai_tournament_data.parquet\")\n\nconsole.print(tree)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-KaggleDownloader-(Numerai-Signals)">3. KaggleDownloader (Numerai Signals)<a class="anchor-link" href="#3.-KaggleDownloader-(Numerai-Signals)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Numerai community maintains some excellent datasets on Kaggle for Numerai Signals.</p>
<p>For example, <a href="https://www.kaggle.com/code1110">Katsu1110</a> maintains a <a href="https://www.kaggle.com/code1110/yfinance-stock-price-data-for-numerai-signals">dataset with yfinance price data</a> on Kaggle that is updated daily. <a href="/numerblox/download.html#KaggleDownloader"><code>KaggleDownloader</code></a> allows you to easily pull data through the Kaggle API. We will be using this dataset in an example below.</p>
<p>In this case, <code>download_inference_data</code> and <code>download_training_data</code> have the same functionality as we can't make the distinction beforehand for an arbitrary dataset on Kaggle.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="KaggleDownloader" class="doc_header"><code>class</code> <code>KaggleDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/download.py#L338" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>KaggleDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>Download awesome financial data from Kaggle.</p>
<p>For authentication, make sure you have a directory called .kaggle in your home directory
with therein a kaggle.json file. kaggle.json should have the following structure:</p>
<p><code>{"username": USERNAME, "key": KAGGLE_API_KEY}</code></p>
<p>More info on authentication: <a href="https://github.com/Kaggle/kaggle-api#api-credentials">https://github.com/Kaggle/kaggle-api#api-credentials</a></p>
<p>More info on the Kaggle Python API: <a href="https://www.kaggle.com/donkeys/kaggle-python-api">https://www.kaggle.com/donkeys/kaggle-python-api</a></p>
<p>| :param directory_path: Base folder to download files to.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="8b9e1479-73db-4f42-98a6-df0738af4f80"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#8b9e1479-73db-4f42-98a6-df0738af4f80');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "# export\nclass KaggleDownloader(BaseDownloader):\n    \"\"\"\n    Download awesome financial data from Kaggle.\n\n    For authentication, make sure you have a directory called .kaggle in your home directory\n    with therein a kaggle.json file. kaggle.json should have the following structure: \\n\n    `{\"username\": USERNAME, \"key\": KAGGLE_API_KEY}` \\n\n    More info on authentication: https://github.com/Kaggle/kaggle-api#api-credentials \\n\n\n    More info on the Kaggle Python API: https://www.kaggle.com/donkeys/kaggle-python-api \\n\n\n    | :param directory_path: Base folder to download files to.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        self.download_training_data(kaggle_dataset_path)\n\n    def download_training_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        kaggle.api.dataset_download_files(kaggle_dataset_path,\n                                          path=self.dir, unzip=True)";
                var nbb_formatted_code = "# export\nclass KaggleDownloader(BaseDownloader):\n    \"\"\"\n    Download awesome financial data from Kaggle.\n\n    For authentication, make sure you have a directory called .kaggle in your home directory\n    with therein a kaggle.json file. kaggle.json should have the following structure: \\n\n    `{\"username\": USERNAME, \"key\": KAGGLE_API_KEY}` \\n\n    More info on authentication: https://github.com/Kaggle/kaggle-api#api-credentials \\n\n\n    More info on the Kaggle Python API: https://www.kaggle.com/donkeys/kaggle-python-api \\n\n\n    | :param directory_path: Base folder to download files to.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        self.download_training_data(kaggle_dataset_path)\n\n    def download_training_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        kaggle.api.dataset_download_files(\n            kaggle_dataset_path, path=self.dir, unzip=True\n        )";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The link to Katsu1110's yfinance price dataset is <a href="https://www.kaggle.com/code1110/yfinance-stock-price-data-for-numerai-signals">https://www.kaggle.com/code1110/yfinance-stock-price-data-for-numerai-signals</a>. In <code>.download_training_data</code> we define the slug after kaggle.com (<code>code1110/yfinance-stock-price-data-for-numerai-signals</code>) as an argument. The full Kaggle dataset is downloaded and unzipped.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">home_directory</span> <span class="o">=</span> <span class="s2">&quot;test_kaggle_downloader&quot;</span>
<span class="n">kd</span> <span class="o">=</span> <span class="n">KaggleDownloader</span><span class="p">(</span><span class="n">home_directory</span><span class="p">)</span>
<span class="n">kd</span><span class="o">.</span><span class="n">download_training_data</span><span class="p">(</span><span class="s2">&quot;code1110/yfinance-stock-price-data-for-numerai-signals&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">test_kaggle_downloader</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>

</div>

</div>

<div class="output_area">




<div id="5395fd73-5995-4523-9c2b-8108e20f4643"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#5395fd73-5995-4523-9c2b-8108e20f4643');

            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "# other\nhome_directory = \"test_kaggle_downloader\"\nkd = KaggleDownloader(home_directory)\nkd.download_training_data(\"code1110/yfinance-stock-price-data-for-numerai-signals\")";
                var nbb_formatted_code = "# other\nhome_directory = \"test_kaggle_downloader\"\nkd = KaggleDownloader(home_directory)\nkd.download_training_data(\"code1110/yfinance-stock-price-data-for-numerai-signals\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This Kaggle dataset contains one file called <code>"full_data.parquet"</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">kd</span><span class="o">.</span><span class="n">dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Path(&#39;test_kaggle_downloader/full_data.parquet&#39;)]</pre>
</div>

</div>

<div class="output_area">




<div id="3030e9ff-637d-4bd5-9011-af23525e7414"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#3030e9ff-637d-4bd5-9011-af23525e7414');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "# other\nlist(kd.dir.iterdir())";
                var nbb_formatted_code = "# other\nlist(kd.dir.iterdir())";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">home_directory</span><span class="si">}</span><span class="s2">/full_data.parquet&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ticker</th>
      <th>date</th>
      <th>close</th>
      <th>raw_close</th>
      <th>high</th>
      <th>low</th>
      <th>open</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000060 KS</td>
      <td>20021202</td>
      <td>4.553156</td>
      <td>1327.944214</td>
      <td>1327.944214</td>
      <td>1327.944214</td>
      <td>1327.944214</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000060 KS</td>
      <td>20021203</td>
      <td>4.643617</td>
      <td>1354.327148</td>
      <td>1354.327148</td>
      <td>1301.561157</td>
      <td>1310.355469</td>
      <td>1319031.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">




<div id="41df11d9-6e17-4504-bd02-352cdfb8cfdb"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#41df11d9-6e17-4504-bd02-352cdfb8cfdb');

            setTimeout(function() {
                var nbb_cell_id = 16;
                var nbb_unformatted_code = "# other\ndf = pd.read_parquet(f\"{home_directory}/full_data.parquet\")\ndf.head(2)";
                var nbb_formatted_code = "# other\ndf = pd.read_parquet(f\"{home_directory}/full_data.parquet\")\ndf.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Folder can be cleaned up when done with inference.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kd</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">⚠ <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'KaggleDownloader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ⚠
Path: 
<span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/test_kaggle_downloader'</span>
</pre>

</div>

</div>

<div class="output_area">




<div id="63b6a36e-09ad-439f-8171-d79788d73555"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#63b6a36e-09ad-439f-8171-d79788d73555');

            setTimeout(function() {
                var nbb_cell_id = 17;
                var nbb_unformatted_code = "# other\nkd.remove_base_directory()";
                var nbb_formatted_code = "# other\nkd.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Custom-Downloader">4. Custom Downloader<a class="anchor-link" href="#4.-Custom-Downloader"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We invite the Numerai Community to implement new downloaders for this project using interesting APIs.</p>
<p>These are especially important for creating innovative Numerai Signals models.</p>
<p>A new Downloader can be created by inheriting from <a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a>. You should implement methods for <code>.download_inference_data</code> and <code>.download_training_data</code> so every downloader has a common interface. Below you will find a template for a new downloader.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AwesomeCustomDownloader" class="doc_header"><code>class</code> <code>AwesomeCustomDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/main/numerblox/download.py#L370" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AwesomeCustomDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <a href="/numerblox/download.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>TEMPLATE -
Download awesome financial data from who knows where.</p>
<p>| :param directory_path: Base folder to download files to.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="5a39e89b-fa6d-4621-a101-7c9e7eef565e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#5a39e89b-fa6d-4621-a101-7c9e7eef565e');

            setTimeout(function() {
                var nbb_cell_id = 18;
                var nbb_unformatted_code = "# export\nclass AwesomeCustomDownloader(BaseDownloader):\n    \"\"\"\n    TEMPLATE -\n    Download awesome financial data from who knows where.\n\n    | :param directory_path: Base folder to download files to.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\" (minimal) weekly inference downloading here. \"\"\"\n        ...\n\n    def download_training_data(self, *args, **kwargs):\n        \"\"\" Training + validation dataset downloading here. \"\"\"\n        ...";
                var nbb_formatted_code = "# export\nclass AwesomeCustomDownloader(BaseDownloader):\n    \"\"\"\n    TEMPLATE -\n    Download awesome financial data from who knows where.\n\n    | :param directory_path: Base folder to download files to.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\"(minimal) weekly inference downloading here.\"\"\"\n        ...\n\n    def download_training_data(self, *args, **kwargs):\n        \"\"\"Training + validation dataset downloading here.\"\"\"\n        ...";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>
 

